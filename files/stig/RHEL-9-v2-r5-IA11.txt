Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025

************************************************************************************************************
IA-11 Re-authentication
************************************************************************************************************

Group ID:
V-258084
Rule ID:
SV-258084r1050789
STIG ID:
RHEL-09-432015
SRG ID:
SRG-OS-000373-GPOS-00156
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must require reauthentication when using the "sudo" command.
Discussion:
Without reauthentication, users may access resources or perform tasks for which they do not have authorization. 

When operating systems provide the capability to escalate a functional capability, it is critical the organization requires the user to reauthenticate when using the "sudo" command.

If the value is set to an integer less than "0", the user's time stamp will not expire and the user will not have to reauthenticate for privileged actions until the user's session is terminated.
Check Text:
Verify RHEL 9 requires reauthentication when using the "sudo" command to elevate privileges with the following command:

$ sudo grep -ir 'timestamp_timeout' /etc/sudoers /etc/sudoers.d/

/etc/sudoers:Defaults timestamp_timeout=0

If results are returned from more than one file location, this is a finding.

If "timestamp_timeout" is set to a negative number, is commented out, or no results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to reauthenticate "sudo" commands after the specified timeout:

Add the following line to "/etc/sudoers" or a file in "/etc/sudoers.d":

Defaults timestamp_timeout=0
CCI-004895
Permit users to invoke the trusted communications path for communications between the user and the organization-defined security functions, including at a minimum, authentication and re-authentication.
NIST SP 800-53 Revision 5 :: SC-11 b
CCI-002038
The organization requires users to reauthenticate upon organization-defined circumstances or situations requiring reauthentication.
NIST SP 800-53 Revision 4 :: IA-11
NIST SP 800-53 Revision 5 :: IA-11

************************************************************************************************************

Group ID:
V-258086
Rule ID:
SV-258086r1102063
STIG ID:
RHEL-09-432025
SRG ID:
SRG-OS-000373-GPOS-00156
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must require users to reauthenticate for privilege escalation.
Discussion:
Without reauthentication, users may access resources or perform tasks for which they do not have authorization.

When operating systems provide the capability to escalate a functional capability, it is critical that the user reauthenticate.

Satisfies: SRG-OS-000373-GPOS-00156, SRG-OS-000373-GPOS-00157, SRG-OS-000373-GPOS-00158
Check Text:
Verify that "/etc/sudoers" has no occurrences of "!authenticate" with the following command:

$ sudo egrep -iR '!authenticate' /etc/sudoers /etc/sudoers.d/

If any occurrences of "!authenticate" are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not allow users to execute privileged actions without authenticating.

Remove any occurrence of "!authenticate" found in "/etc/sudoers" file or files in the "/etc/sudoers.d" directory.

$ sudo sed -i '/\!authenticate/ s/^/# /g' /etc/sudoers /etc/sudoers.d/*
CCI-004895
Permit users to invoke the trusted communications path for communications between the user and the organization-defined security functions, including at a minimum, authentication and re-authentication.
NIST SP 800-53 Revision 5 :: SC-11 b
CCI-002038
The organization requires users to reauthenticate upon organization-defined circumstances or situations requiring reauthentication.
NIST SP 800-53 Revision 4 :: IA-11
NIST SP 800-53 Revision 5 :: IA-11

************************************************************************************************************

Group ID:
V-258088
Rule ID:
SV-258088r1050789
STIG ID:
RHEL-09-432035
SRG ID:
SRG-OS-000373-GPOS-00156
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must restrict the use of the "su" command.
Discussion:
The "su" program allows to run commands with a substitute user and group ID. It is commonly used to run commands as the root user. Limiting access to such commands is considered a good security practice.

Satisfies: SRG-OS-000373-GPOS-00156, SRG-OS-000312-GPOS-00123
Check Text:
Verify that RHEL 9 requires uses to be members of the "wheel" group with the following command:

$ grep pam_wheel /etc/pam.d/su 

auth             required        pam_wheel.so use_uid 

If a line for "pam_wheel.so" does not exist, or is commented out, this is a finding.
Fix Text:
Configure RHEL 9 to require users to be in the "wheel" group to run "su" command.

In file "/etc/pam.d/su", uncomment the following line:

"#auth    required    pam_wheel.so use_uid"

$ sed '/^[[:space:]]*#[[:space:]]*auth[[:space:]]\+required[[:space:]]\+pam_wheel\.so[[:space:]]\+use_uid$/s/^[[:space:]]*#//' -i /etc/pam.d/su

If necessary, create a "wheel" group and add administrative users to the group.
CCI-004895
Permit users to invoke the trusted communications path for communications between the user and the organization-defined security functions, including at a minimum, authentication and re-authentication.
NIST SP 800-53 Revision 5 :: SC-11 b
CCI-002165
Enforce organization-defined discretionary access control policies over defined subjects and objects.
NIST SP 800-53 Revision 4 :: AC-3 (4)
NIST SP 800-53 Revision 5 :: AC-3 (4)
CCI-002038
The organization requires users to reauthenticate upon organization-defined circumstances or situations requiring reauthentication.
NIST SP 800-53 Revision 4 :: IA-11
NIST SP 800-53 Revision 5 :: IA-11

************************************************************************************************************

Group ID:
V-258106
Rule ID:
SV-258106r1102061
STIG ID:
RHEL-09-611085
SRG ID:
SRG-OS-000373-GPOS-00156
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must require users to provide a password for privilege escalation.
Discussion:
Without reauthentication, users may access resources or perform tasks for which they do not have authorization.

When operating systems provide the capability to escalate a functional capability, it is critical that the user reauthenticate.

Satisfies: SRG-OS-000373-GPOS-00156, SRG-OS-000373-GPOS-00157, SRG-OS-000373-GPOS-00158
Check Text:
Verify that "/etc/sudoers" has no occurrences of "NOPASSWD" with the following command:

$ sudo grep -iR 'NOPASSWD' /etc/sudoers /etc/sudoers.d/

If any occurrences of "NOPASSWD" are returned from the command and have not been documented with the information system security officer (ISSO) as an organizationally defined administrative group using multifactor authentication (MFA), this is a finding.
Fix Text:
Configure RHEL 9 to not allow users to execute privileged actions without authenticating with a password.

Remove any occurrence of "NOPASSWD" found in "/etc/sudoers" file or files in the "/etc/sudoers.d" directory.

$ sudo find /etc/sudoers /etc/sudoers.d -type f -exec sed -i '/NOPASSWD/ s/^/# /g' {} \;
CCI-004895
Permit users to invoke the trusted communications path for communications between the user and the organization-defined security functions, including at a minimum, authentication and re-authentication.
NIST SP 800-53 Revision 5 :: SC-11 b
CCI-002038
The organization requires users to reauthenticate upon organization-defined circumstances or situations requiring reauthentication.
NIST SP 800-53 Revision 4 :: IA-11
NIST SP 800-53 Revision 5 :: IA-11

************************************************************************************************************

Group ID:
V-258118
Rule ID:
SV-258118r1050789
STIG ID:
RHEL-09-611145
SRG ID:
SRG-OS-000373-GPOS-00156
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not be configured to bypass password requirements for privilege escalation.
Discussion:
Without reauthentication, users may access resources or perform tasks for which they do not have authorization. When operating systems provide the capability to escalate a functional capability, it is critical the user reauthenticate.

Satisfies: SRG-OS-000373-GPOS-00156, SRG-OS-000373-GPOS-00157, SRG-OS-000373-GPOS-00158
Check Text:
Verify the operating system is not configured to bypass password requirements for privilege escalation with the following command:

$ sudo grep pam_succeed_if /etc/pam.d/sudo 

If any occurrences of "pam_succeed_if" are returned, this is a finding.
Fix Text:
Configure the operating system to require users to supply a password for privilege escalation.

Remove any occurrences of " pam_succeed_if " in the  "/etc/pam.d/sudo" file.
CCI-004895
Permit users to invoke the trusted communications path for communications between the user and the organization-defined security functions, including at a minimum, authentication and re-authentication.
NIST SP 800-53 Revision 5 :: SC-11 b
CCI-002038
The organization requires users to reauthenticate upon organization-defined circumstances or situations requiring reauthentication.
NIST SP 800-53 Revision 4 :: IA-11
NIST SP 800-53 Revision 5 :: IA-11

