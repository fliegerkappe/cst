Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025

************************************************************************************************************
CM-3 Configuration Change Control
************************************************************************************************************

Group ID:
V-257842
Rule ID:
SV-257842r1044916
STIG ID:
RHEL-09-215095
SRG ID:
SRG-OS-000363-GPOS-00150
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must have the s-nail package installed.
Discussion:
The "s-nail" package provides the mail command required to allow sending email notifications of unauthorized configuration changes to designated personnel.
Check Text:
Verify that RHEL 9 is configured to allow sending email notifications.

Note: The "s-nail" package provides the "mail" command that is used to send email messages.

Verify that the "s-nail" package is installed on the system:

$ dnf list --installed s-nail

s-nail.x86_64          14.9.22-6.el9
	 
If "s-nail" package is not installed, this is a finding.
Fix Text:
The s-nail package can be installed with the following command:

$ sudo dnf install s-nail
CCI-001744
Implement organization-defined security responses automatically if baseline configurations are changed in an unauthorized manner.
NIST SP 800-53 Revision 5 :: CM-3 (5)
NIST SP 800-53 Revision 4 :: CM-3 (5)

************************************************************************************************************

Group ID:
V-258134
Rule ID:
SV-258134r1101983
STIG ID:
RHEL-09-651010
SRG ID:
SRG-OS-000363-GPOS-00150
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must have the AIDE package installed.
Discussion:
Without verification of the security functions, security functions may not operate correctly, and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.

Selection lines in the aide.conf file determine which files and directories AIDE will monitor for changes. They follow this format:

<path> <rules>

The <path> specifies a file, directory or wildcard pattern to monitor.
The <rules>define which attributes (hashes, permissions, timestamps, etc.) to check.

Satisfies: SRG-OS-000363-GPOS-00150, SRG-OS-000445-GPOS-00199
Check Text:
Verify the file integrity tool is configured to verify ACLs.

Note: AIDE is highly configurable at install time. This requirement assumes the "aide.conf" file is under the "/etc" directory.

If AIDE is not installed, ask the system administrator (SA) how file integrity checks are performed on the system.

Use the following command to determine if the file is in a location other than "/etc/aide/aide.conf":

$ sudo find / -name aide.conf

Use the following command to review the "aide.conf" file to determine if the "acl" rule has been added to the rule list being applied to the files and directories selection lists:

$ sudo cat /etc/aide.conf | more

If the "acl" rule is not being used on all selection lines in the "/etc/aide.conf" file, is commented out, or ACLs are not being checked by another file integrity tool, this is a finding.
Fix Text:
Install AIDE, initialize it, and perform a manual check.

Install AIDE:

$ sudo dnf install aide

Initialize AIDE:
     
$ sudo /usr/sbin/aide --init

Example output:

Start timestamp: 2023-06-05 10:09:04 -0600 (AIDE 0.16)
AIDE initialized database at /var/lib/aide/aide.db.new.gz

Number of entries:      86833

---------------------------------------------------
The attributes of the (uncompressed) database(s):
---------------------------------------------------

/var/lib/aide/aide.db.new.gz
  MD5      : coZUtPHhoFoeD7+k54fUvQ==
  SHA1     : DVpOEMWJwo0uPgrKZAygIUgSxeM=
  SHA256   : EQiZH0XNEk001tcDmJa+5STFEjDb4MPE
             TGdBJ/uvZKc=
  SHA512   : 86KUqw++PZhoPK0SZvT3zuFq9yu9nnPP
             toei0nENVELJ1LPurjoMlRig6q69VR8l
             +44EwO9eYyy9nnbzQsfG1g==

End timestamp: 2023-06-05 10:09:57 -0600 (run time: 0m 53s)

The new database will need to be renamed to be read by AIDE:

$ sudo mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz

Perform a manual check:

$ sudo /usr/sbin/aide --check

Example output:

2023-06-05 10:16:08 -0600 (AIDE 0.16)
AIDE found NO differences between database and filesystem. Looks okay!!

...
CCI-001744
Implement organization-defined security responses automatically if baseline configurations are changed in an unauthorized manner.
NIST SP 800-53 Revision 5 :: CM-3 (5)
NIST SP 800-53 Revision 4 :: CM-3 (5)
CCI-002696
Verify correct operation of organization-defined security functions.
NIST SP 800-53 Revision 4 :: SI-6 a
NIST SP 800-53 Revision 5 :: SI-6 a

************************************************************************************************************

Group ID:
V-258135
Rule ID:
SV-258135r1045267
STIG ID:
RHEL-09-651015
SRG ID:
SRG-OS-000363-GPOS-00150
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must routinely check the baseline configuration for unauthorized changes and notify the system administrator when anomalies in the operation of any security functions are discovered.
Discussion:
Unauthorized changes to the baseline configuration could make the system vulnerable to various attacks or allow unauthorized access to the operating system. Changes to operating system configurations can have unintended side effects, some of which may be relevant to security.

Detecting such changes and providing an automated response can help avoid unintended, negative consequences that could ultimately affect the security state of the operating system. The operating system's information management officer (IMO)/information system security officer (ISSO) and system administrators (SAs) must be notified via email and/or monitoring system trap when there is an unauthorized modification of a configuration item.

Notifications provided by information systems include messages to local computer consoles, and/or hardware indications, such as lights.

This capability must take into account operational requirements for availability for selecting an appropriate response. The organization may choose to shut down or restart the information system upon security function anomaly detection.

Satisfies: SRG-OS-000363-GPOS-00150, SRG-OS-000446-GPOS-00200, SRG-OS-000447-GPOS-00201
Check Text:
Verify that RHEL 9 routinely executes a file integrity scan for changes to the system baseline. The command used in the example will use a daily occurrence.

Check the cron directories for scripts controlling the execution and notification of results of the file integrity application. For example, if AIDE is installed on the system, use the following commands:

$ sudo ls -al /etc/cron.* | grep aide

-rwxr-xr-x 1 root root 29 Nov 22 2015 aide

$ sudo grep aide /etc/crontab /var/spool/cron/root

/etc/crontab: 30 04 * * * root usr/sbin/aide
/var/spool/cron/root: 30 04 * * * root usr/sbin/aide

$ sudo more /etc/cron.daily/aide

#!/bin/bash
/usr/sbin/aide --check | /bin/mail -s "$HOSTNAME - Daily aide integrity check run" root@sysname.mil

If the file integrity application does not exist, a script file controlling the execution of the file integrity application does not exist, or the file integrity application does not notify designated personnel of changes, this is a finding.
Fix Text:
Configure the file integrity tool to run automatically on the system at least weekly and to notify designated personnel if baseline configurations are changed in an unauthorized manner. The AIDE tool can be configured to email designated personnel with the use of the cron system.
 
The following example output is generic. It will set cron to run AIDE daily and to send email at the completion of the analysis

$ sudo more /etc/cron.daily/aide
 
#!/bin/bash
/usr/sbin/aide --check | /bin/mail -s "$HOSTNAME - Daily aide integrity check run" root@sysname.mil
CCI-001744
Implement organization-defined security responses automatically if baseline configurations are changed in an unauthorized manner.
NIST SP 800-53 Revision 5 :: CM-3 (5)
NIST SP 800-53 Revision 4 :: CM-3 (5)
CCI-002699
Perform verification of the correct operation of organization-defined security functions: when the system is in an organization-defined transitional state; upon command by a user with appropriate privileges; and/or on an organization-defined frequency.
NIST SP 800-53 Revision 4 :: SI-6 b
NIST SP 800-53 Revision 5 :: SI-6 b
CCI-002702
Shut the system down, restart the system, and/or initiate organization-defined alternative action(s) when anomalies in the operation of the organization-defined security functions are discovered.
NIST SP 800-53 Revision 4 :: SI-6 d
NIST SP 800-53 Revision 5 :: SI-6 d
