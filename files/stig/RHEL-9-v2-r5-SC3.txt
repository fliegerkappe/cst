Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025

************************************************************************************************************
SC-3 Security Function Isolation
************************************************************************************************************

Group ID:
V-258078
Rule ID:
SV-258078r958944
STIG ID:
RHEL-09-431010
SRG ID:
SRG-OS-000445-GPOS-00199
Severity:
CAT I
Classification
Unclassified
Rule Title:
RHEL 9 must use a Linux Security Module configured to enforce limits on system services.
Discussion:
Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.

This requirement applies to operating systems performing security function verification/testing and/or systems and environments that require this functionality.

Satisfies: SRG-OS-000445-GPOS-00199, SRG-OS-000134-GPOS-00068
Check Text:
Ensure that RHEL 9 verifies correct operation of security functions through the use of SELinux with the following command:

$ getenforce

Enforcing

If SELINUX is not set to "Enforcing", this is a finding.

Verify that SELinux is configured to be enforcing at boot.

grep "SELINUX=" /etc/selinux/config
# SELINUX= can take one of these three values:
# NOTE: In earlier Fedora kernel builds, SELINUX=disabled would also
SELINUX=enforcing

If SELINUX line is missing, commented out, or not set to "enforcing", this is a finding.
Fix Text:
Configure RHEL 9 to verify correct operation of security functions.

Edit the file "/etc/selinux/config" and add or modify the following line:

 SELINUX=enforcing 

A reboot is required for the changes to take effect.
CCI-001084
Isolate security functions from nonsecurity functions.
NIST SP 800-53 :: SC-3
NIST SP 800-53A :: SC-3.1 (ii)
NIST SP 800-53 Revision 4 :: SC-3
NIST SP 800-53 Revision 5 :: SC-3
CCI-002696
Verify correct operation of organization-defined security functions.
NIST SP 800-53 Revision 4 :: SI-6 a
NIST SP 800-53 Revision 5 :: SI-6 a

************************************************************************************************************

Group ID:
V-257792
Rule ID:
SV-257792r1044842
STIG ID:
RHEL-09-212035
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable virtual system calls.
Discussion:
System calls are special routines in the Linux kernel, which userspace applications ask to do privileged tasks. Invoking a system call is an expensive operation because the processor must interrupt the currently executing task and switch context to kernel mode and then back to userspace after the system call completes. Virtual system calls map into user space a page that contains some variables and the implementation of some system calls. This allows the system calls to be executed in userspace to alleviate the context switching expense.

Virtual system calls provide an opportunity of attack for a user who has control of the return instruction pointer. Disabling virtual system calls help to prevent return oriented programming (ROP) attacks via buffer overflows and overruns. If the system intends to run containers based on RHEL 6 components, then virtual system calls will need enabled so the components function properly.

Satisfies: SRG-OS-000480-GPOS-00227, SRG-OS-000134-GPOS-00068
Check Text:
Verify the current GRUB 2 configuration disables virtual system calls with the following command:

$ sudo grubby --info=ALL | grep args | grep -v 'vsyscall=none'

If any output is returned, this is a finding.

Check that virtual system calls are disabled by default to persist in kernel updates with the following command: 

$ sudo grep vsyscall /etc/default/grub

GRUB_CMDLINE_LINUX="vsyscall=none"

If "vsyscall" is not set to "none", is missing or commented out, and is not documented with the information system security officer (ISSO) as an operational requirement, this is a finding.
Fix Text:
Document the use of virtual system calls with the ISSO as an operational requirement or disable them with the following command:

$ sudo grubby --update-kernel=ALL --args="vsyscall=none"

Add or modify the following line in "/etc/default/grub" to ensure the configuration survives kernel updates:

GRUB_CMDLINE_LINUX="vsyscall=none"
CCI-001084
Isolate security functions from nonsecurity functions.
NIST SP 800-53 :: SC-3
NIST SP 800-53A :: SC-3.1 (ii)
NIST SP 800-53 Revision 4 :: SC-3
NIST SP 800-53 Revision 5 :: SC-3

************************************************************************************************************

Group ID:
V-257793
Rule ID:
SV-257793r1044843
STIG ID:
RHEL-09-212040
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must clear the page allocator to prevent use-after-free attacks.
Discussion:
Poisoning writes an arbitrary value to freed pages, so any modification or reference to that page after being freed or before being initialized will be detected and prevented. This prevents many types of use-after-free vulnerabilities at little performance cost. Also prevents leak of data and detection of corrupted memory.

Satisfies: SRG-OS-000480-GPOS-00227, SRG-OS-000134-GPOS-00068
Check Text:
Verify that GRUB 2 is configured to enable page poisoning to mitigate use-after-free vulnerabilities.

Check that the current GRUB 2 configuration has page poisoning enabled  with the following command:

$ sudo grubby --info=ALL | grep args | grep -v 'page_poison=1'

If any output is returned, this is a finding.

Check that page poisoning is enabled by default to persist in kernel updates with the following command: 

$ sudo grep page_poison /etc/default/grub

GRUB_CMDLINE_LINUX="page_poison=1"

If "page_poison" is not set to "1", is missing or commented out, this is a finding.
Fix Text:
Configure RHEL 9 to enable page poisoning with the following commands:

$ sudo grubby --update-kernel=ALL --args="page_poison=1"

Add or modify the following line in "/etc/default/grub" to ensure the configuration survives kernel updates:

GRUB_CMDLINE_LINUX="page_poison=1"
CCI-001084
Isolate security functions from nonsecurity functions.
NIST SP 800-53 :: SC-3
NIST SP 800-53A :: SC-3.1 (ii)
NIST SP 800-53 Revision 4 :: SC-3
NIST SP 800-53 Revision 5 :: SC-3

************************************************************************************************************

Group ID:
V-257794
Rule ID:
SV-257794r1069362
STIG ID:
RHEL-09-212045
SRG ID:
SRG-OS-000433-GPOS-00192
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must clear memory when it is freed to prevent use-after-free attacks.
Discussion:
Some adversaries launch attacks with the intent of executing code in nonexecutable regions of memory or in memory locations that are prohibited. Security safeguards employed to protect memory include, for example, data execution prevention and address space layout randomization. Data execution prevention safeguards can be either hardware-enforced or software-enforced with hardware providing the greater strength of mechanism.

Poisoning writes an arbitrary value to freed pages, so any modification or reference to that page after being freed or before being initialized will be detected and prevented. This prevents many types of use-after-free vulnerabilities at little performance cost. Also prevents leak of data and detection of corrupted memory.

init_on_free is a Linux kernel boot parameter that enhances security by initializing memory regions when they are freed, preventing data leakage. This process ensures that stale data in freed memory cannot be accessed by malicious programs.

SLUB canaries add a randomized value (canary) at the end of SLUB-allocated objects to detect memory corruption caused by buffer overflows or underflows. Redzoning adds padding (red zones) around SLUB-allocated objects to detect overflows or underflows by triggering a fault when adjacent memory is accessed. SLUB canaries are often more efficient and provide stronger detection against buffer overflows compared to redzoning. SLUB canaries are supported in hardened Linux kernels like the ones provided by Linux-hardened.

SLAB objects are blocks of physically contiguous memory. SLUB is the unqueued SLAB allocator.

Satisfies: SRG-OS-000433-GPOS-00192, SRG-OS-000134-GPOS-00068
Check Text:
Verify that GRUB2 is configured to mitigate use-after-free vulnerabilities by employing memory poisoning.

Inspect the "GRUB_CMDLINE_LINUX" entry of /etc/default/grub as follows:
$ sudo grep -i grub_cmdline_linux /etc/default/grub
GRUB_CMDLINE_LINUX="... init_on_free=1"

If "init_on_free=1" is missing or commented out, this is a finding.
Fix Text:
Configure RHEL 9 to enable init_on_free with the following command:
$ sudo grubby --update-kernel=ALL --args="init_on_free=1"

Regenerate the GRUB configuration:
$ sudo grub2-mkconfig -o /boot/grub2/grub.cfg

Reboot the system:
$ sudo reboot
CCI-001084
Isolate security functions from nonsecurity functions.
NIST SP 800-53 :: SC-3
NIST SP 800-53A :: SC-3.1 (ii)
NIST SP 800-53 Revision 4 :: SC-3
NIST SP 800-53 Revision 5 :: SC-3
CCI-002824
Implement organization-defined controls to protect the system memory from unauthorized code execution.
NIST SP 800-53 Revision 4 :: SI-16
NIST SP 800-53 Revision 5 :: SI-16

************************************************************************************************************

Group ID:
V-258081
Rule ID:
SV-258081r1045164
STIG ID:
RHEL-09-431025
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must have policycoreutils package installed.
Discussion:
Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.

Policycoreutils contains the policy core utilities that are required for basic operation of an SELinux-enabled system. These utilities include load_policy to load SELinux policies, setfile to label filesystems, newrole to switch roles, and run_init to run /etc/init.d scripts in the proper context.

Satisfies: SRG-OS-000480-GPOS-00227, SRG-OS-000134-GPOS-00068
Check Text:
Verify RHEL 9 has the policycoreutils package installed with the following command:

$ dnf list --installed policycoreutils

Example output:

policycoreutils.x86_64          3.3-6.el9_0                                                 

If the "policycoreutils" package is not installed, this is a finding.
Fix Text:
The policycoreutils package can be installed with the following command:
 
$ sudo dnf install policycoreutils
CCI-001084
Isolate security functions from nonsecurity functions.
NIST SP 800-53 :: SC-3
NIST SP 800-53A :: SC-3.1 (ii)
NIST SP 800-53 Revision 4 :: SC-3
NIST SP 800-53 Revision 5 :: SC-3



