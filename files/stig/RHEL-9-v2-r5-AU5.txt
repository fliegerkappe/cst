Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025

************************************************************************************************************
AU-5 Response to Audit Processing Failures
************************************************************************************************************

Group ID:
V-257953
Rule ID:
SV-257953r958424
STIG ID:
RHEL-09-252060
SRG ID:
SRG-OS-000046-GPOS-00022
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must forward mail from postmaster to the root account using a postfix alias.
Discussion:
It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.

Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.
Check Text:
Verify that the administrators are notified in the event of an audit processing failure.

Check that the "/etc/aliases" file has a defined value for "root".

$ sudo grep "postmaster:\s*root$" /etc/aliases

If the command does not return a line, or the line is commented out, ask the system administrator to indicate how they and the information systems security officer (ISSO) are notified of an audit process failure. If there is no evidence of the proper personnel being notified of an audit processing failure, this is a finding.
Fix Text:
Configure a valid email address as an alias for the root account.

Append the following line to "/etc/aliases":

postmaster: root

Then, run the following command:

$ sudo newaliases
CCI-000139
Alert organization-defined personnel or roles within an organization-defined time period in the event of an audit logging process failure.
NIST SP 800-53 :: AU-5 a
NIST SP 800-53A :: AU-5.1 (ii)
NIST SP 800-53 Revision 4 :: AU-5 a
NIST SP 800-53 Revision 5 :: AU-5 a

************************************************************************************************************

Group ID:
V-258157
Rule ID:
SV-258157r971542
STIG ID:
RHEL-09-653040
SRG ID:
SRG-OS-000343-GPOS-00134
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must notify the system administrator (SA) and information system security officer (ISSO) (at a minimum) when allocated audit record storage volume 75 percent utilization.
Discussion:
If security personnel are not notified immediately when storage volume reaches 75 percent utilization, they are unable to plan for audit record storage capacity expansion.
Check Text:
Verify RHEL 9 notifies the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity with the following command:

$ sudo grep -w space_left_action /etc/audit/auditd.conf

space_left_action = email

If the value of the "space_left_action" is not set to "email", or if the line is commented out, ask the SA to indicate how the system is providing real-time alerts to the SA and ISSO.

If there is no evidence that real-time alerts are configured on the system, this is a finding.
Fix Text:
Configure RHEL 9 to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity by adding/modifying the following line in the /etc/audit/auditd.conf file.

space_left_action = email
CCI-001855
Provide a warning to organization-defined personnel, roles, and/or locations within an organization-defined time period when allocated audit log storage volume reaches an organization-defined percentage of repository maximum audit log storage capacity.
NIST SP 800-53 Revision 4 :: AU-5 (1)
NIST SP 800-53 Revision 5 :: AU-5 (1)

************************************************************************************************************

Group ID:
V-258158
Rule ID:
SV-258158r971542
STIG ID:
RHEL-09-653045
SRG ID:
SRG-OS-000343-GPOS-00134
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must take action when allocated audit record storage volume reaches 95 percent of the audit record storage capacity.
Discussion:
If action is not taken when storage volume reaches 95 percent utilization, the auditing system may fail when the storage volume reaches capacity.
Check Text:
Verify RHEL 9 takes action when allocated audit record storage volume reaches 95 percent of the repository maximum audit record storage capacity with the following command:

$ sudo grep -w admin_space_left /etc/audit/auditd.conf

admin_space_left = 5%

If the value of the "admin_space_left" keyword is not set to 5 percent of the storage volume allocated to audit logs, or if the line is commented out, ask the system administrator (SA) to indicate how the system is taking action if the allocated storage is about to reach capacity. If the "space_left" value is not configured to the correct value, this is a finding.
Fix Text:
Configure RHEL 9 to initiate an action when allocated audit record storage volume reaches 95 percent of the repository maximum audit record storage capacity by adding/modifying the following line in the /etc/audit/auditd.conf file.

admin_space_left  = 5%
CCI-001855
Provide a warning to organization-defined personnel, roles, and/or locations within an organization-defined time period when allocated audit log storage volume reaches an organization-defined percentage of repository maximum audit log storage capacity.
NIST SP 800-53 Revision 4 :: AU-5 (1)
NIST SP 800-53 Revision 5 :: AU-5 (1)

************************************************************************************************************

Group ID:
V-258159
Rule ID:
SV-258159r971542
STIG ID:
RHEL-09-653050
SRG ID:
SRG-OS-000343-GPOS-00134
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must take action when allocated audit record storage volume reaches 95 percent of the repository maximum audit record storage capacity.
Discussion:
If action is not taken when storage volume reaches 95 percent utilization, the auditing system may fail when the storage volume reaches capacity.
Check Text:
Verify that RHEL 9 is configured to take action in the event of allocated audit record storage volume reaches 95 percent of the repository maximum audit record storage capacity with the following command:

$ sudo grep admin_space_left_action /etc/audit/auditd.conf

admin_space_left_action = single

If the value of the "admin_space_left_action" is not set to "single", or if the line is commented out, ask the system administrator (SA) to indicate how the system is providing real-time alerts to the SA and information system security officer (ISSO).

If there is no evidence that real-time alerts are configured on the system, this is a finding.
Fix Text:
Configure "auditd" service  to take action in the event of allocated audit record storage volume reaches 95 percent of the repository maximum audit record storage capacity.

Edit the following line in "/etc/audit/auditd.conf" to ensure that the system is forced into single user mode in the event the audit record storage volume is about to reach maximum capacity:

admin_space_left_action = single 

The audit daemon must be restarted for changes to take effect.
CCI-001855
Provide a warning to organization-defined personnel, roles, and/or locations within an organization-defined time period when allocated audit log storage volume reaches an organization-defined percentage of repository maximum audit log storage capacity.
NIST SP 800-53 Revision 4 :: AU-5 (1)
NIST SP 800-53 Revision 5 :: AU-5 (1)

************************************************************************************************************

Group ID:
V-258163
Rule ID:
SV-258163r958424
STIG ID:
RHEL-09-653070
SRG ID:
SRG-OS-000046-GPOS-00022
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 System Administrator (SA) and/or information system security officer (ISSO) (at a minimum) must be alerted of an audit processing failure event.
Discussion:
It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.

Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.

This requirement applies to each audit data storage repository (i.e., distinct information system component where audit records are stored), the centralized audit storage capacity of organizations (i.e., all audit data storage repositories combined), or both.

Satisfies: SRG-OS-000046-GPOS-00022, SRG-OS-000343-GPOS-00134
Check Text:
Verify that RHEL 9 is configured to notify the SA and/or ISSO (at a minimum) in the event of an audit processing failure with the following command:

$ sudo grep action_mail_acct /etc/audit/auditd.conf

action_mail_acct = root

If the value of the "action_mail_acct" keyword is not set to "root" and/or other accounts for security personnel, the "action_mail_acct" keyword is missing, or the retuned line is commented out, ask the SA to indicate how they and the ISSO are notified of an audit process failure. If there is no evidence of the proper personnel being notified of an audit processing failure, this is a finding.
Fix Text:
Configure "auditd" service to notify the SA and ISSO in the event of an audit processing failure.

Edit the following line in "/etc/audit/auditd.conf" to ensure that administrators are notified via email for those situations:

action_mail_acct = root

The audit daemon must be restarted for changes to take effect.
CCI-000139
Alert organization-defined personnel or roles within an organization-defined time period in the event of an audit logging process failure.
NIST SP 800-53 :: AU-5 a
NIST SP 800-53A :: AU-5.1 (ii)
NIST SP 800-53 Revision 4 :: AU-5 a
NIST SP 800-53 Revision 5 :: AU-5 a
CCI-001855
Provide a warning to organization-defined personnel, roles, and/or locations within an organization-defined time period when allocated audit log storage volume reaches an organization-defined percentage of repository maximum audit log storage capacity.
NIST SP 800-53 Revision 4 :: AU-5 (1)
NIST SP 800-53 Revision 5 :: AU-5 (1)

************************************************************************************************************

Group ID:
V-258174
Rule ID:
SV-258174r958424
STIG ID:
RHEL-09-653125
SRG ID:
SRG-OS-000046-GPOS-00022
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must have mail aliases to notify the information system security officer (ISSO) and system administrator (SA) (at a minimum) in the event of an audit processing failure.
Discussion:
It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.

Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.

This requirement applies to each audit data storage repository (i.e., distinct information system component where audit records are stored), the centralized audit storage capacity of organizations (i.e., all audit data storage repositories combined), or both.
Check Text:
Verify that RHEL 9 is configured to notify the appropriate interactive users in the event of an audit processing failure.

Find the alias maps that are being used with the following command:

$ postconf alias_maps 

alias_maps = hash:/etc/aliases

Query the Postfix alias maps for an alias for the root user with the following command:

$ postmap -q root hash:/etc/aliases
isso

If an alias is not set, this is a finding.
Fix Text:
Edit the aliases map file (by default /etc/aliases) used by Postfix and configure a root alias (using the user ISSO as an example):

root:    ISSO

and then update the aliases database with the command:

$ sudo newaliases
CCI-000139
Alert organization-defined personnel or roles within an organization-defined time period in the event of an audit logging process failure.
NIST SP 800-53 :: AU-5 a
NIST SP 800-53A :: AU-5.1 (ii)
NIST SP 800-53 Revision 4 :: AU-5 a
NIST SP 800-53 Revision 5 :: AU-5 a

************************************************************************************************************

Group ID:
V-258153
Rule ID:
SV-258153r1038966
STIG ID:
RHEL-09-653020
SRG ID:
SRG-OS-000047-GPOS-00023
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 audit system must take appropriate action when an error writing to the audit storage volume occurs.
Discussion:
It is critical that when the operating system is at risk of failing to process audit logs as required, it takes action to mitigate the failure. Audit processing failures include software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.
Check Text:
Verify RHEL 9 takes the appropriate action when an audit processing failure occurs.

Check that RHEL 9 takes the appropriate action when an audit processing failure occurs with the following command:

$ sudo grep disk_error_action /etc/audit/auditd.conf

disk_error_action = HALT

If the value of the "disk_error_action" option is not "SYSLOG", "SINGLE", or "HALT", or the line is commented out, ask the system administrator (SA) to indicate how the system takes appropriate action when an audit process failure occurs. If there is no evidence of appropriate action, this is a finding.
Fix Text:
Configure RHEL 9 to shut down by default upon audit failure (unless availability is an overriding concern).

Add or update the following line (depending on configuration "disk_error_action" can be set to "SYSLOG" or "SINGLE" depending on configuration) in "/etc/audit/auditd.conf" file:

disk_error_action = HALT

If availability has been determined to be more important, and this decision is documented with the information system security officer (ISSO), configure the operating system to notify SA staff and ISSO staff in the event of an audit processing failure by setting the "disk_error_action" to "SYSLOG".
CCI-000140
Take organization-defined actions upon audit failure include, shutting down the system, overwriting oldest audit records, and stopping the generation of audit records.
NIST SP 800-53 :: AU-5 b
NIST SP 800-53A :: AU-5.1 (iv)
NIST SP 800-53 Revision 4 :: AU-5 b
NIST SP 800-53 Revision 5 :: AU-5 b

************************************************************************************************************

Group ID:
V-258154
Rule ID:
SV-258154r1038966
STIG ID:
RHEL-09-653025
SRG ID:
SRG-OS-000047-GPOS-00023
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 audit system must take appropriate action when the audit storage volume is full.
Discussion:
It is critical that when the operating system is at risk of failing to process audit logs as required, it takes action to mitigate the failure. Audit processing failures include software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.
Check Text:
Verify RHEL 9 takes the appropriate action when the audit storage volume is full. 

Check that RHEL 9 takes the appropriate action when the audit storage volume is full with the following command:

$ sudo grep disk_full_action /etc/audit/auditd.conf

disk_full_action = HALT

If the value of the "disk_full_action" option is not "SYSLOG", "SINGLE", or "HALT", or the line is commented out, ask the system administrator (SA) to indicate how the system takes appropriate action when an audit storage volume is full. If there is no evidence of appropriate action, this is a finding.
Fix Text:
Configure RHEL 9 to shut down by default upon audit failure (unless availability is an overriding concern).

Add or update the following line (depending on configuration "disk_full_action" can be set to "SYSLOG" or "SINGLE" depending on configuration) in "/etc/audit/auditd.conf" file:

disk_full_action = HALT

If availability has been determined to be more important, and this decision is documented with the information system security officer (ISSO), configure the operating system to notify SA staff and ISSO staff in the event of an audit processing failure by setting the "disk_full_action" to "SYSLOG".
CCI-000140
Take organization-defined actions upon audit failure include, shutting down the system, overwriting oldest audit records, and stopping the generation of audit records.
NIST SP 800-53 :: AU-5 b
NIST SP 800-53A :: AU-5.1 (iv)
NIST SP 800-53 Revision 4 :: AU-5 b
NIST SP 800-53 Revision 5 :: AU-5 b

************************************************************************************************************

Group ID:
V-258156
Rule ID:
SV-258156r1106364
STIG ID:
RHEL-09-653035
SRG ID:
SRG-OS-000343-GPOS-00134
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must take action when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity.
Discussion:
If security personnel are not notified immediately when storage volume reaches a maximum of 75 percent utilization, they are unable to plan for audit record storage capacity expansion. The notification can be set to trigger at lower utilization thresholds at the information system security officer's (ISSO's) discretion.
Check Text:
Verify RHEL 9 takes action when allocated audit record storage volume reaches 75 percent of the repository maximum audit record storage capacity with the following command:

$ sudo grep -w space_left /etc/audit/auditd.conf

space_left = 25%

If the value of the "space_left" keyword is not set to 25 percent or greater of the storage volume allocated to audit logs, or if the line is commented out, ask the system administrator (SA) to indicate how the system is providing real-time alerts to the SA and ISSO. If the "space_left" value is not configured to the value 25 percent or more, this is a finding.
Fix Text:
Configure RHEL 9 to initiate an action to notify the SA and ISSO (at a minimum) when allocated audit record storage volume reaches (at most) 75 percent of the repository maximum audit record storage capacity by adding/modifying the following line in the /etc/audit/auditd.conf file.

space_left  = 25%
CCI-001855
Provide a warning to organization-defined personnel, roles, and/or locations within an organization-defined time period when allocated audit log storage volume reaches an organization-defined percentage of repository maximum audit log storage capacity.
NIST SP 800-53 Revision 4 :: AU-5 (1)
NIST SP 800-53 Revision 5 :: AU-5 (1)

************************************************************************************************************

Group ID:
V-258160
Rule ID:
SV-258160r1038966
STIG ID:
RHEL-09-653055
SRG ID:
SRG-OS-000047-GPOS-00023
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 audit system must take appropriate action when the audit files have reached maximum size.
Discussion:
It is critical that when the operating system is at risk of failing to process audit logs as required, it takes action to mitigate the failure. Audit processing failures include software/hardware errors; failures in the audit capturing mechanisms; and audit storage capacity being reached or exceeded. Responses to audit failure depend upon the nature of the failure mode.
Check Text:
Verify that RHEL 9 takes the appropriate action when the audit files have reached maximum size with the following command:

$ sudo grep max_log_file_action /etc/audit/auditd.conf

max_log_file_action = ROTATE

If the value of the "max_log_file_action" option is not "ROTATE", "SINGLE", or the line is commented out, ask the system administrator (SA)to indicate how the system takes appropriate action when an audit storage volume is full. If there is no evidence of appropriate action, this is a finding.
Fix Text:
Configure RHEL 9 to rotate the audit log when it reaches maximum size.

Add or update the following line in "/etc/audit/auditd.conf" file:

max_log_file_action = ROTATE
CCI-000140
Take organization-defined actions upon audit failure include, shutting down the system, overwriting oldest audit records, and stopping the generation of audit records.
NIST SP 800-53 :: AU-5 b
NIST SP 800-53A :: AU-5.1 (iv)
NIST SP 800-53 Revision 4 :: AU-5 b
NIST SP 800-53 Revision 5 :: AU-5 b

************************************************************************************************************

Group ID:
V-258227
Rule ID:
SV-258227r1014992
STIG ID:
RHEL-09-654265
SRG ID:
SRG-OS-000046-GPOS-00022
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must take appropriate action when a critical audit processing failure occurs.
Discussion:
It is critical for the appropriate personnel to be aware if a system is at risk of failing to process audit logs as required. Without this notification, the security personnel may be unaware of an impending failure of the audit capability, and system operation may be adversely affected.

Audit processing failures include software/hardware errors, failures in the audit capturing mechanisms, and audit storage capacity being reached or exceeded.

Satisfies: SRG-OS-000046-GPOS-00022, SRG-OS-000047-GPOS-00023
Check Text:
Verify the audit service is configured to panic on a critical error with the following command:

$ sudo grep "\-f" /etc/audit/audit.rules 

-f 2

If the value for "-f" is not "2", and availability is not documented as an overriding concern, this is a finding.
Fix Text:
Configure RHEL 9 to shut down when auditing failures occur.

Add the following line to the bottom of the /etc/audit/rules.d/audit.rules file:

-f 2
CCI-000139
Alert organization-defined personnel or roles within an organization-defined time period in the event of an audit logging process failure.
NIST SP 800-53 :: AU-5 a
NIST SP 800-53A :: AU-5.1 (ii)
NIST SP 800-53 Revision 4 :: AU-5 a
NIST SP 800-53 Revision 5 :: AU-5 a
CCI-000140
Take organization-defined actions upon audit failure include, shutting down the system, overwriting oldest audit records, and stopping the generation of audit records.
NIST SP 800-53 :: AU-5 b
NIST SP 800-53A :: AU-5.1 (iv)
NIST SP 800-53 Revision 4 :: AU-5 b
NIST SP 800-53 Revision 5 :: AU-5 b
