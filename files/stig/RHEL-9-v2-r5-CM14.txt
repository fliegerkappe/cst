Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025

************************************************************************************************************
CM-14 Signed Components
************************************************************************************************************

Group ID:
V-257799
Rule ID:
SV-257799r1106273
STIG ID:
RHEL-09-213020
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent the loading of a new kernel for later execution.
Discussion:
Changes to any software components can have significant effects on the overall security of the operating system. This requirement ensures the software has not been tampered with and that it has been provided by a trusted vendor.

Disabling kexec_load prevents an unsigned kernel image (that could be a windows kernel or modified vulnerable kernel) from being loaded. Kexec can be used subvert the entire secureboot process and should be avoided at all costs especially since it can load unsigned kernel images.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf

Satisfies: SRG-OS-000480-GPOS-00227, SRG-OS-000366-GPOS-00153
Check Text:
Verify RHEL 9 is configured to disable kernel image loading.

Check the status of the kernel.kexec_load_disabled kernel parameter.

$ sudo sysctl kernel.kexec_load_disabled

kernel.kexec_load_disabled = 1

If "kernel.kexec_load_disabled" is not set to "1" or is missing, this is a finding.

Check that the configuration files are present to enable this kernel parameter.

$ sudo grep -r kernel.kexec_load_disabled /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf:kernel.kexec_load_disabled = 1

If "kernel.kexec_load_disabled" is not set to "1", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

kernel.kexec_load_disabled = 1

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-003992
Prevent the installation of organization-defined software and firmware components without verification that the component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 5 :: CM-14
CCI-001749
The information system prevents the installation of organization-defined software components without verification the software component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 4 :: CM-5 (3)

************************************************************************************************************

Group ID:
V-257819
Rule ID:
SV-257819r1015075
STIG ID:
RHEL-09-214010
SRG ID:
SRG-OS-000366-GPOS-00153
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must ensure cryptographic verification of vendor software packages.
Discussion:
Cryptographic verification of vendor software packages ensures that all software packages are obtained from a valid source and protects against spoofing that could lead to installation of malware on the system. Red Hat cryptographically signs all software packages, which includes updates, with a GPG key to verify that they are valid.
Check Text:
Confirm Red Hat package-signing keys are installed on the system and verify their fingerprints match vendor values.

Note: For RHEL 9 software packages, Red Hat uses GPG keys labeled "release key 2" and "auxiliary key 3". The keys are defined in key file "/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release" by default.

List Red Hat GPG keys installed on the system:

$ sudo rpm -q --queryformat "%{SUMMARY}\n" gpg-pubkey | grep -i "red hat"

Red Hat, Inc. (release key 2) <security@redhat.com> public key
Red Hat, Inc. (auxiliary key 3) <security@redhat.com> public key

If Red Hat GPG keys "release key 2" and "auxiliary key 3" are not installed, this is a finding.

List key fingerprints of installed Red Hat GPG keys:

$ sudo gpg -q --keyid-format short --with-fingerprint /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release

If key file "/etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release" is missing, this is a finding.

Example output:

pub   rsa4096/FD431D51 2009-10-22 [SC]
      Key fingerprint = 567E 347A D004 4ADE 55BA  8A5F 199E 2F91 FD43 1D51
uid                   Red Hat, Inc. (release key 2) <security@redhat.com>
pub   rsa4096/5A6340B3 2022-03-09 [SC]
      Key fingerprint = 7E46 2425 8C40 6535 D56D  6F13 5054 E4A4 5A63 40B3
uid                   Red Hat, Inc. (auxiliary key 3) <security@redhat.com>

Compare key fingerprints of installed Red Hat GPG keys with fingerprints listed for RHEL 9 on Red Hat "Product Signing Keys" webpage at https://access.redhat.com/security/team/key.

If key fingerprints do not match, this is a finding.
Fix Text:
Install Red Hat package-signing keys on the system and verify their fingerprints match vendor values.

Insert RHEL 9 installation disc or attach RHEL 9 installation image to the system. Mount the disc or image to make the contents accessible inside the system.

Assuming the mounted location is "/media/cdrom", use the following command to copy Red Hat GPG key file onto the system:

$ sudo cp /media/cdrom/RPM-GPG-KEY-redhat-release /etc/pki/rpm-gpg/
	 
Import Red Hat GPG keys from key file into system keyring:

$ sudo rpm --import /etc/pki/rpm-gpg/RPM-GPG-KEY-redhat-release
	 
Using the steps listed in the Check Text, confirm the newly imported keys show as installed on the system and verify their fingerprints match vendor values.
CCI-003992
Prevent the installation of organization-defined software and firmware components without verification that the component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 5 :: CM-14
CCI-001749
The information system prevents the installation of organization-defined software components without verification the software component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 4 :: CM-5 (3)

************************************************************************************************************

Group ID:
V-257820
Rule ID:
SV-257820r1044878
STIG ID:
RHEL-09-214015
SRG ID:
SRG-OS-000366-GPOS-00153
Severity:
CAT I
Classification
Unclassified
Rule Title:
RHEL 9 must check the GPG signature of software packages originating from external software repositories before installation.
Discussion:
Changes to any software components can have significant effects on the overall security of the operating system. This requirement ensures the software has not been tampered with and that it has been provided by a trusted vendor.

All software packages must be signed with a cryptographic key recognized and approved by the organization.

Verifying the authenticity of software prior to installation validates the integrity of the software package received from a vendor. This verifies the software has not been tampered with and that it has been provided by a trusted vendor.
Check Text:
Verify that dnf always checks the GPG signature of software packages originating from external software repositories before installation:

$ grep -w gpgcheck /etc/dnf/dnf.conf

gpgcheck=1

If "gpgcheck" is not set to "1", or if the option is missing or commented out, ask the system administrator how the GPG signatures of software packages are being verified.

If there is no process to verify GPG signatures that is approved by the organization, this is a finding.
Fix Text:
Configure dnf to always check the GPG signature of software packages originating from external software repositories before installation.

Add or update the following line in the [main] section of the /etc/dnf/dnf.conf file:

gpgcheck=1
CCI-003992
Prevent the installation of organization-defined software and firmware components without verification that the component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 5 :: CM-14
CCI-001749
The information system prevents the installation of organization-defined software components without verification the software component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 4 :: CM-5 (3)

************************************************************************************************************

Group ID:
V-257821
Rule ID:
SV-257821r1015077
STIG ID:
RHEL-09-214020
SRG ID:
SRG-OS-000366-GPOS-00153
Severity:
CAT I
Classification
Unclassified
Rule Title:
RHEL 9 must check the GPG signature of locally installed software packages before installation.
Discussion:
Changes to any software components can have significant effects on the overall security of the operating system. This requirement ensures the software has not been tampered with and that it has been provided by a trusted vendor.

All software packages must be signed with a cryptographic key recognized and approved by the organization.

Verifying the authenticity of software prior to installation validates the integrity of the software package received from a vendor. This verifies the software has not been tampered with and that it has been provided by a trusted vendor.
Check Text:
Verify that dnf always checks the GPG signature of locally installed software packages before installation:

$ grep localpkg_gpgcheck /etc/dnf/dnf.conf 

localpkg_gpgcheck=1 

If "localpkg_gpgcheck" is not set to "1", or if the option is missing or commented out, ask the system administrator how the GPG signatures of local software packages are being verified.

If there is no process to verify GPG signatures that is approved by the organization, this is a finding.
Fix Text:
Configure dnf to always check the GPG signature of local software packages before installation.

Add or update the following line in the [main] section of the /etc/dnf/dnf.conf file:

localpkg_gpgcheck=1
CCI-003992
Prevent the installation of organization-defined software and firmware components without verification that the component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 5 :: CM-14
CCI-001749
The information system prevents the installation of organization-defined software components without verification the software component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 4 :: CM-5 (3)

************************************************************************************************************

Group ID:
V-257822
Rule ID:
SV-257822r1044880
STIG ID:
RHEL-09-214025
SRG ID:
SRG-OS-000366-GPOS-00153
Severity:
CAT I
Classification
Unclassified
Rule Title:
RHEL 9 must have GPG signature verification enabled for all software repositories.
Discussion:
Changes to any software components can have significant effects on the overall security of the operating system. This requirement ensures the software has not been tampered with and that it has been provided by a trusted vendor.

All software packages must be signed with a cryptographic key recognized and approved by the organization.

Verifying the authenticity of software prior to installation validates the integrity of the software package received from a vendor. This verifies the software has not been tampered with and that it has been provided by a trusted vendor.
Check Text:
Verify that all software repositories defined in "/etc/yum.repos.d/" have been configured with "gpgcheck" enabled:

$ grep -w gpgcheck /etc/yum.repos.d/*.repo | more

gpgcheck = 1

If "gpgcheck" is not set to "1" for all returned lines, this is a finding.
Fix Text:
Configure all software repositories defined in "/etc/yum.repos.d/" to have "gpgcheck" enabled:

$ sudo sed -i 's/gpgcheck\s*=.*/gpgcheck=1/g' /etc/yum.repos.d/*
CCI-003992
Prevent the installation of organization-defined software and firmware components without verification that the component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 5 :: CM-14
CCI-001749
The information system prevents the installation of organization-defined software components without verification the software component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 4 :: CM-5 (3)

************************************************************************************************************

Group ID:
V-257825
Rule ID:
SV-257825r1044888
STIG ID:
RHEL-09-215010
SRG ID:
SRG-OS-000366-GPOS-00153
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 subscription-manager package must be installed.
Discussion:
The Red Hat Subscription Manager application manages software subscriptions and software repositories for installed software products on the local system. It communicates with backend servers, such as the Red Hat Customer Portal or an on-premise instance of Subscription Asset Manager, to register the local system and grant access to software resources determined by the subscription entitlement.
Check Text:
Verify that RHEL 9 subscription-manager package is installed with the following command:

$ dnf list --installed subscription-manager

Example output:

subscription-manager.x86_64          1.29.26-3.el9_0

If the "subscription-manager" package is not installed, this is a finding.
Fix Text:
The  subscription-manager package can be installed with the following command:
 
$ sudo dnf install subscription-manager
CCI-003992
Prevent the installation of organization-defined software and firmware components without verification that the component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 5 :: CM-14
CCI-001749
The information system prevents the installation of organization-defined software components without verification the software component has been digitally signed using a certificate that is recognized and approved by the organization.
NIST SP 800-53 Revision 4 :: CM-5 (3)
