Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025

************************************************************************************************************
CM-6 Configuration Settings
************************************************************************************************************

Group ID:
V-257777
Rule ID:
SV-257777r991589
STIG ID:
RHEL-09-211010
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT I
Classification
Unclassified
Rule Title:
RHEL 9 must be a vendor-supported release.
Discussion:
An operating system release is considered "supported" if the vendor continues to provide security patches for the product. With an unsupported release, it will not be possible to resolve security issues discovered in the system software.

Red Hat offers the Extended Update Support (EUS) add-on to a Red Hat Enterprise Linux subscription, for a fee, for those customers who wish to standardize on a specific minor release for an extended period.
Check Text:
Verify that the version or RHEL 9 is vendor supported with the following command:

$ cat /etc/redhat-release 

Red Hat Enterprise Linux release 9.2 (Plow)

If the installed version of RHEL 9 is not supported, this is a finding.
Fix Text:
Upgrade to a supported version of RHEL 9.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257778
Rule ID:
SV-257778r991589
STIG ID:
RHEL-09-211015
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 vendor packaged system security patches and updates must be installed and up to date.
Discussion:
Installing software updates is a fundamental mitigation against the exploitation of publicly known vulnerabilities. If the most recent security patches and updates are not installed, unauthorized users may take advantage of weaknesses in the unpatched software. The lack of prompt attention to patching could result in a system compromise.
Check Text:
Verify RHEL 9 security patches and updates are installed and up to date. Updates are required to be applied with a frequency determined by organizational policy.

Obtain the list of available package security updates from Red Hat. The URL for updates is https://access.redhat.com/errata-search/. It is important to note that updates provided by Red Hat may not be present on the system if the underlying packages are not installed.

Check that the available package security updates have been installed on the system with the following command:

$ dnf history list | more

    ID | Command line | Date and time | Action(s) | Altered    
-------------------------------------------------------------------------------    
   70 | install aide | 2023-03-05 10:58 | Install | 1    
   69 | update -y | 2023-03-04 14:34 | Update | 18 EE    
   68 | install vlc | 2023-02-21 17:12 | Install | 21   
   67 | update -y | 2023-02-21 17:04 | Update | 7 EE 

Typical update frequency may be overridden by Information Assurance Vulnerability Alert (IAVA) notifications from CYBERCOM.

If the system is in noncompliance with the organizational patching policy, this is a finding.
Fix Text:
Install RHEL 9 security patches and updates at the organizationally defined frequency. If system updates are installed via a centralized repository that is configured on the system, all updates can be installed with the following command:

$ sudo dnf update
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257781
Rule ID:
SV-257781r991589
STIG ID:
RHEL-09-211030
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
The graphical display manager must not be the default target on RHEL 9 unless approved.
Discussion:
Unnecessary service packages must not be installed to decrease the attack surface of the system. Graphical display managers have a long history of security vulnerabilities and must not be used, unless approved and documented.
Check Text:
Verify that RHEL 9 is configured to boot to the command line:

$ systemctl get-default

multi-user.target

If the system default target is not set to "multi-user.target" and the information system security officer (ISSO) lacks a documented requirement for a graphical user interface, this is a finding.
Fix Text:
Document the requirement for a graphical user interface with the ISSO or set the default target to multi-user with the following command:

$ sudo systemctl set-default multi-user.target
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257782
Rule ID:
SV-257782r991589
STIG ID:
RHEL-09-211035
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT III
Classification
Unclassified
Rule Title:
RHEL 9 must enable the hardware random number generator entropy gatherer service.
Discussion:
The most important characteristic of a random number generator is its randomness, namely its ability to deliver random numbers that are impossible to predict. Entropy in computer security is associated with the unpredictability of a source of randomness. The random source with high entropy tends to achieve a uniform distribution of random values. Random number generators are one of the most important building blocks of cryptosystems.  

The rngd service feeds random data from hardware device to kernel random device. Quality (nonpredictable) random number generation is important for several security functions (i.e., ciphers).
Check Text:
Note: For RHEL 9 systems running with kernel FIPS mode enabled as specified by RHEL-09-671010, this requirement is Not Applicable.

Verify that RHEL 9 has enabled the hardware random number generator entropy gatherer service with the following command:

$ systemctl is-active rngd

active

If the "rngd" service is not active, this is a finding.
Fix Text:
Install the rng-tools package with the following command:

$ sudo dnf install rng-tools

Then enable the rngd service run the following command:

$ sudo systemctl enable --now rngd
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257790
Rule ID:
SV-257790r991589
STIG ID:
RHEL-09-212025
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /boot/grub2/grub.cfg file must be group-owned by root.
Discussion:
The "root" group is a highly privileged group. Furthermore, the group-owner of this file should not have any access privileges anyway.
Check Text:
Verify the group ownership of the "/boot/grub2/grub.cfg" file with the following command:

$ sudo stat -c "%G %n" /boot/grub2/grub.cfg 

root /boot/grub2/grub.cfg

If "/boot/grub2/grub.cfg" file does not have a group owner of "root", this is a finding.
Fix Text:
Change the group of the file /boot/grub2/grub.cfg to root by running the following command:

$ sudo chgrp root /boot/grub2/grub.cfg
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257791
Rule ID:
SV-257791r991589
STIG ID:
RHEL-09-212030
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /boot/grub2/grub.cfg file must be owned by root.
Discussion:
The " /boot/grub2/grub.cfg" file stores sensitive system configuration. Protection of this file is critical for system security.
Check Text:
Verify the ownership of the "/boot/grub2/grub.cfg" file with the following command:

$ sudo stat -c "%U %n" /boot/grub2/grub.cfg 

root /boot/grub2/grub.cfg 

If "/boot/grub2/grub.cfg" file does not have an owner of "root", this is a finding.
Fix Text:
Change the owner of the file /boot/grub2/grub.cfg to root by running the following command:

$ sudo chown root /boot/grub2/grub.cfg
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257813
Rule ID:
SV-257813r991589
STIG ID:
RHEL-09-213090
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable storing core dumps.
Discussion:
A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers or system operators trying to debug problems. Enabling core dumps on production systems is not recommended; however, there may be overriding operational requirements to enable advanced debugging. Permitting temporary enablement of core dumps during such situations must be reviewed through local needs and policy.
Check Text:
Verify RHEL 9 disables storing core dumps for all users by issuing the following command:

$ grep -i storage /etc/systemd/coredump.conf

Storage=none

If the "Storage" item is missing, commented out, or the value is anything other than "none" and the need for core dumps is not documented with the information system security officer (ISSO) as an operational requirement for all domains that have the "core" item assigned, this is a finding.
Fix Text:
Configure the operating system to disable storing core dumps for all users.

Add or modify the following line in /etc/systemd/coredump.conf:

Storage=none
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257814
Rule ID:
SV-257814r991589
STIG ID:
RHEL-09-213095
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable core dumps for all users.
Discussion:
A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems.
Check Text:
Verify RHEL 9 disables core dumps for all users by issuing the following command:

$ grep -r -s core /etc/security/limits.conf /etc/security/limits.d/*.conf

/etc/security/limits.conf:* hard core 0

This can be set as a global domain (with the * wildcard) but may be set differently for multiple domains.

If the "core" item is missing, commented out, or the value is anything other than "0" and the need for core dumps is not documented with the information system security officer (ISSO) as an operational requirement for all domains that have the "core" item assigned, this is a finding.
Fix Text:
Configure the operating system to disable core dumps for all users.

Add the following line to the top of the /etc/security/limits.conf or in a single ".conf" file defined in /etc/security/limits.d/:

* hard core 0
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257815
Rule ID:
SV-257815r991589
STIG ID:
RHEL-09-213100
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable acquiring, saving, and processing core dumps.
Discussion:
A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems.
Check Text:
Verify RHEL 9 is not configured to acquire, save, or process core dumps with the following command:

$ sudo systemctl status systemd-coredump.socket

systemd-coredump.socket
Loaded: masked (Reason: Unit systemd-coredump.socket is masked.)
Active: inactive (dead)

If the "systemd-coredump.socket" is loaded and not masked and the need for core dumps is not documented with the information system security officer (ISSO) as an operational requirement, this is a finding.
Fix Text:
Configure the system to disable the systemd-coredump.socket with the following command:

$ sudo systemctl mask --now systemd-coredump.socket

Created symlink /etc/systemd/system/systemd-coredump.socket -> /dev/null

Reload the daemon for this change to take effect.

$ sudo systemctl daemon-reload
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257839
Rule ID:
SV-257839r991589
STIG ID:
RHEL-09-215080
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must have the gnutls-utils package installed.
Discussion:
GnuTLS is a secure communications library implementing the SSL, TLS and DTLS protocols and technologies around them. It provides a simple C language application programming interface (API) to access the secure communications protocols as well as APIs to parse and write X.509, PKCS #12, OpenPGP and other required structures. This package contains command line TLS client and server and certificate manipulation tools.
Check Text:
Verify that RHEL 9 has the gnutls-utils package installed with the following command:

$ dnf list --installed gnutls-utils

Example output:

gnutls-utils.x86_64          3.7.3-9.el9

If the "gnutls-utils" package is not installed, this is a finding.
Fix Text:
The gnutls-utils package can be installed with the following command:
 
$ sudo dnf install gnutls-utils
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257840
Rule ID:
SV-257840r991589
STIG ID:
RHEL-09-215085
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must have the nss-tools package installed.
Discussion:
Network Security Services (NSS) is a set of libraries designed to support cross-platform development of security-enabled client and server applications. Install the "nss-tools" package to install command-line tools to manipulate the NSS certificate and key database.
Check Text:
Verify that RHEL 9 has the nss-tools package installed with the following command:

$ dnf list --installed nss-tools

Example output:

nss-tools.x86_64          3.71.0-7.el9

If the "nss-tools" package is not installed, this is a finding.
Fix Text:
The nss-tools package can be installed with the following command:
 
$ sudo dnf install nss-tools
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257843
Rule ID:
SV-257843r991589
STIG ID:
RHEL-09-231010
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
A separate RHEL 9 file system must be used for user home directories (such as /home or an equivalent).
Discussion:
Ensuring that "/home" is mounted on its own partition enables the setting of more restrictive mount options, and also helps ensure that users cannot trivially fill partitions used for log or audit data storage.
Check Text:
Verify that a separate file system/partition has been created for "/home" with the following command:

$ mount | grep /home

UUID=fba5000f-2ffa-4417-90eb-8c54ae74a32f on /home type ext4 (rw,nodev,nosuid,noexec,seclabel)

If a separate entry for "/home" is not in use, this is a finding.
Fix Text:
Migrate the "/home" directory onto a separate file system/partition.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257852
Rule ID:
SV-257852r991589
STIG ID:
RHEL-09-231055
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent code from being executed on file systems that contain user home directories.
Discussion:
The "noexec" mount option causes the system to not execute binary files. This option must be used for mounting any file system not containing approved binary files, as they may be incompatible. Executing files from untrusted file systems increases the opportunity for nonprivileged users to attain unauthorized administrative access.
Check Text:
Verify "/home" is mounted with the "noexec" option with the following command:

Note: If a separate file system has not been created for the user home directories (user home directories are mounted under "/"), this is automatically a finding, as the "noexec" option cannot be used on the "/" system.

$ mount | grep /home

tmpfs on /home type xfs (rw,nodev,nosuid,noexec,seclabel)

If the "/home" file system is mounted without the "noexec" option, this is a finding.
Fix Text:
Modify "/etc/fstab" to use the "noexec" option on the "/home" directory.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257857
Rule ID:
SV-257857r991589
STIG ID:
RHEL-09-231080
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent code from being executed on file systems that are used with removable media.
Discussion:
The "noexec" mount option causes the system not to execute binary files. This option must be used for mounting any file system not containing approved binary files, as they may be incompatible. Executing files from untrusted file systems increases the opportunity for nonprivileged users to attain unauthorized administrative access.
Check Text:
Verify file systems that are used for removable media are mounted with the "noexec" option with the following command:

$ more /etc/fstab

UUID=2bc871e4-e2a3-4f29-9ece-3be60c835222 /mnt/usbflash vfat noauto,owner,ro,nosuid,nodev,noexec 0 0

If a file system found in "/etc/fstab" refers to removable media and it does not have the "noexec" option set, this is a finding.
Fix Text:
Configure the "/etc/fstab" to use the "noexec" option on file systems that are associated with removable media.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257858
Rule ID:
SV-257858r991589
STIG ID:
RHEL-09-231085
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent special devices on file systems that are used with removable media.
Discussion:
The "nodev" mount option causes the system not to interpret character or block special devices. Executing character or blocking special devices from untrusted file systems increases the opportunity for nonprivileged users to attain unauthorized administrative access.
Check Text:
Verify file systems that are used for removable media are mounted with the "nodev" option with the following command:

$ more /etc/fstab

UUID=2bc871e4-e2a3-4f29-9ece-3be60c835222 /mnt/usbflash vfat noauto,owner,ro,nosuid,nodev,noexec 0 0

If a file system found in "/etc/fstab" refers to removable media and it does not have the "nodev" option set, this is a finding.
Fix Text:
Configure the "/etc/fstab" to use the "nodev" option on file systems that are associated with removable media.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257859
Rule ID:
SV-257859r991589
STIG ID:
RHEL-09-231090
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems that are used with removable media.
Discussion:
The "nosuid" mount option causes the system not to execute "setuid" and "setgid" files with owner privileges. This option must be used for mounting any file system not containing approved "setuid" and "setguid" files. Executing files from untrusted file systems increases the opportunity for nonprivileged users to attain unauthorized administrative access.
Check Text:
Verify file systems that are used for removable media are mounted with the "nosuid" option with the following command:

$ more /etc/fstab

UUID=2bc871e4-e2a3-4f29-9ece-3be60c835222 /mnt/usbflash vfat noauto,owner,ro,nosuid,nodev,noexec 0 0

If a file system found in "/etc/fstab" refers to removable media and it does not have the "nosuid" option set, this is a finding.
Fix Text:
Configure the "/etc/fstab" to use the "nosuid" option on file systems that are associated with removable media.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257881
Rule ID:
SV-257881r991589
STIG ID:
RHEL-09-231200
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent special devices on non-root local partitions.
Discussion:
The "nodev" mount option causes the system to not interpret character or block special devices. Executing character or block special devices from untrusted file systems increases the opportunity for nonprivileged users to attain unauthorized administrative access.

The only legitimate location for device files is the "/dev" directory located on the root partition, with the exception of chroot jails if implemented.
Check Text:
Verify all non-root local partitions are mounted with the "nodev" option with the following command:

$ sudo mount | grep '^/dev\S* on /\S' | grep --invert-match 'nodev'

If any output is produced, this is a finding.
Fix Text:
Configure the "/etc/fstab" to use the "nodev" option on all non-root local partitions.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257891
Rule ID:
SV-257891r991589
STIG ID:
RHEL-09-232055
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/group file must have mode 0644 or less permissive to prevent unauthorized access.
Discussion:
The "/etc/group" file contains information regarding groups that are configured on the system. Protection of this file is important for system security.
Check Text:
Verify that the "/etc/group" file has mode "0644" or less permissive with the following command:

$ sudo stat -c "%a %n" /etc/group

644 /etc/group

If a value of "0644" or less permissive is not returned, this is a finding.
Fix Text:
Change the mode of the file "/etc/group" to "0644" by running the following command:

$ sudo chmod 0644 /etc/group
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257892
Rule ID:
SV-257892r991589
STIG ID:
RHEL-09-232060
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/group- file must have mode 0644 or less permissive to prevent unauthorized access.
Discussion:
The "/etc/group-" file is a backup file of "/etc/group", and as such, contains information regarding groups that are configured on the system. Protection of this file is important for system security.
Check Text:
Verify that the "/etc/group-" file has mode "0644" or less permissive with the following command:

$ sudo stat -c "%a %n" /etc/group-

644 /etc/group-

If a value of "0644" or less permissive is not returned, this is a finding.
Fix Text:
Change the mode of the file "/etc/group-" to "0644" by running the following command:

$ sudo chmod 0644 /etc/group-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257893
Rule ID:
SV-257893r991589
STIG ID:
RHEL-09-232065
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/gshadow file must have mode 0000 or less permissive to prevent unauthorized access.
Discussion:
The "/etc/gshadow" file contains group password hashes. Protection of this file is critical for system security.
Check Text:
Verify that the "/etc/gshadow" file has mode "0000" with the following command:

$ sudo stat -c "%a %n" /etc/gshadow

0 /etc/gshadow

If a value of "0" is not returned, this is a finding.
Fix Text:
Change the mode of the file "/etc/gshadow" to "0000" by running the following command:

$ sudo chmod 0000 /etc/gshadow
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257894
Rule ID:
SV-257894r991589
STIG ID:
RHEL-09-232070
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/gshadow- file must have mode 0000 or less permissive to prevent unauthorized access.
Discussion:
The "/etc/gshadow-" file is a backup of "/etc/gshadow", and as such, contains group password hashes. Protection of this file is critical for system security.
Check Text:
Verify that the "/etc/gshadow-" file has mode "0000" with the following command:

$ sudo stat -c "%a %n" /etc/gshadow-

0 /etc/gshadow-

If a value of "0" is not returned, this is a finding.
Fix Text:
Change the mode of the file "/etc/gshadow-" to "0000" by running the following command:

$ sudo chmod 0000 /etc/gshadow-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257895
Rule ID:
SV-257895r991589
STIG ID:
RHEL-09-232075
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/passwd file must have mode 0644 or less permissive to prevent unauthorized access.
Discussion:
If the "/etc/passwd" file is writable by a group-owner or the world the risk of its compromise is increased. The file contains the list of accounts on the system and associated information, and protection of this file is critical for system security.
Check Text:
Verify that the "/etc/passwd" file has mode "0644" or less permissive with the following command:

$ sudo stat -c "%a %n" /etc/passwd

644 /etc/passwd

If a value of "0644" or less permissive is not returned, this is a finding.
Fix Text:
Change the mode of the file "/etc/passwd" to "0644" by running the following command:

$ sudo chmod 0644 /etc/passwd
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257896
Rule ID:
SV-257896r991589
STIG ID:
RHEL-09-232080
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/passwd- file must have mode 0644 or less permissive to prevent unauthorized access.
Discussion:
The "/etc/passwd-" file is a backup file of "/etc/passwd", and as such, contains information about the users that are configured on the system. Protection of this file is critical for system security.
Check Text:
Verify that the "/etc/passwd-" file has mode "0644" or less permissive with the following command:

$ sudo stat -c "%a %n" /etc/passwd-

644 /etc/passwd-

If a value of "0644" or less permissive is not returned, this is a finding.
Fix Text:
Change the mode of the file "/etc/passwd-" to "0644" by running the following command:

$ sudo chmod 0644 /etc/passwd-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257897
Rule ID:
SV-257897r991589
STIG ID:
RHEL-09-232085
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/shadow- file must have mode 0000 or less permissive to prevent unauthorized access.
Discussion:
The "/etc/shadow-" file is a backup file of "/etc/shadow", and as such, contains the list of local system accounts and password hashes. Protection of this file is critical for system security.
Check Text:
Verify that the "/etc/shadow-" file has mode "0000" with the following command:

$ sudo stat -c "%a %n" /etc/shadow-

0 /etc/shadow-

If a value of "0" is not returned, this is a finding.
Fix Text:
Change the mode of the file "/etc/shadow-" to "0000" by running the following command:

$ sudo chmod 0000 /etc/shadow-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257898
Rule ID:
SV-257898r991589
STIG ID:
RHEL-09-232090
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/group file must be owned by root.
Discussion:
The "/etc/group" file contains information regarding groups that are configured on the system. Protection of this file is important for system security.
Check Text:
Verify the ownership of the "/etc/group" file with the following command:

$ sudo stat -c "%U %n" /etc/group 

root /etc/group 

If "/etc/group" file does not have an owner of "root", this is a finding.
Fix Text:
Change the owner of the file /etc/group to root by running the following command:

$ sudo chown root /etc/group
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257899
Rule ID:
SV-257899r991589
STIG ID:
RHEL-09-232095
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/group file must be group-owned by root.
Discussion:
The "/etc/group" file contains information regarding groups that are configured on the system. Protection of this file is important for system security.
Check Text:
Verify the group ownership of the "/etc/group" file with the following command:

$ sudo stat -c "%G %n" /etc/group 

root /etc/group

If "/etc/group" file does not have a group owner of "root", this is a finding.
Fix Text:
Change the group of the file /etc/group to root by running the following command:

$ sudo chgrp root /etc/group
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257900
Rule ID:
SV-257900r991589
STIG ID:
RHEL-09-232100
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/group- file must be owned by root.
Discussion:
The "/etc/group-" file is a backup file of "/etc/group", and as such, contains information regarding groups that are configured on the system. Protection of this file is important for system security.
Check Text:
Verify the ownership of the "/etc/group-" file with the following command:

$ sudo stat -c "%U %n" /etc/group- 

root /etc/group- 

If "/etc/group-" file does not have an owner of "root", this is a finding.
Fix Text:
Change the owner of the file /etc/group- to root by running the following command:

$ sudo chown root /etc/group-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257901
Rule ID:
SV-257901r991589
STIG ID:
RHEL-09-232105
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/group- file must be group-owned by root.
Discussion:
The "/etc/group-" file is a backup file of "/etc/group", and as such, contains information regarding groups that are configured on the system. Protection of this file is important for system security.
Check Text:
Verify the group ownership of the "/etc/group-" file with the following command:

$ sudo stat -c "%G %n" /etc/group- 

root /etc/group-

If "/etc/group-" file does not have a group owner of "root", this is a finding.
Fix Text:
Change the group of the file /etc/group- to root by running the following command:

$ sudo chgrp root /etc/group-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257902
Rule ID:
SV-257902r991589
STIG ID:
RHEL-09-232110
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/gshadow file must be owned by root.
Discussion:
The "/etc/gshadow" file contains group password hashes. Protection of this file is critical for system security.
Check Text:
Verify the ownership of the "/etc/gshadow" file with the following command:

$ sudo stat -c "%U %n" /etc/gshadow 

root /etc/gshadow 

If "/etc/gshadow" file does not have an owner of "root", this is a finding.
Fix Text:
Change the owner of the file /etc/gshadow to root by running the following command:

$ sudo chown root /etc/gshadow
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257903
Rule ID:
SV-257903r991589
STIG ID:
RHEL-09-232115
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/gshadow file must be group-owned by root.
Discussion:
The "/etc/gshadow" file contains group password hashes. Protection of this file is critical for system security.
Check Text:
Verify the group ownership of the "/etc/gshadow" file with the following command:

$ sudo stat -c "%G %n" /etc/gshadow 

root /etc/gshadow

If "/etc/gshadow" file does not have a group owner of "root", this is a finding.
Fix Text:
Change the group of the file /etc/gshadow to root by running the following command:

$ sudo chgrp root /etc/gshadow
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257904
Rule ID:
SV-257904r991589
STIG ID:
RHEL-09-232120
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/gshadow- file must be owned by root.
Discussion:
The "/etc/gshadow-" file is a backup of "/etc/gshadow", and as such, contains group password hashes. Protection of this file is critical for system security.
Check Text:
Verify the ownership of the "/etc/gshadow-" file with the following command:

$ sudo stat -c "%U %n" /etc/gshadow- 

root /etc/gshadow- 

If "/etc/gshadow-" file does not have an owner of "root", this is a finding.
Fix Text:
Change the owner of the file /etc/gshadow- to root by running the following command:

$ sudo chown root /etc/gshadow-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257905
Rule ID:
SV-257905r991589
STIG ID:
RHEL-09-232125
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/gshadow- file must be group-owned by root.
Discussion:
The "/etc/gshadow-" file is a backup of "/etc/gshadow", and as such, contains group password hashes. Protection of this file is critical for system security.
Check Text:
Verify the group ownership of the "/etc/gshadow-" file with the following command:

$ sudo stat -c "%G %n" /etc/gshadow- 

root /etc/gshadow-

If "/etc/gshadow-" file does not have a group owner of "root", this is a finding.
Fix Text:
Change the group of the file /etc/gshadow- to root by running the following command:

$ sudo chgrp root /etc/gshadow-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257906
Rule ID:
SV-257906r991589
STIG ID:
RHEL-09-232130
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/passwd file must be owned by root.
Discussion:
The "/etc/passwd" file contains information about the users that are configured on the system. Protection of this file is critical for system security.
Check Text:
Verify the ownership of the "/etc/passwd" file with the following command:

$ sudo stat -c "%U %n" /etc/passwd

root /etc/passwd

If "/etc/passwd" file does not have an owner of "root", this is a finding.
Fix Text:
Change the owner of the file /etc/passwd to root by running the following command:

$ sudo chown root /etc/passwd
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257907
Rule ID:
SV-257907r991589
STIG ID:
RHEL-09-232135
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/passwd file must be group-owned by root.
Discussion:
The "/etc/passwd" file contains information about the users that are configured on the system. Protection of this file is critical for system security.
Check Text:
Verify the group ownership of the "/etc/passwd" file with the following command:

$ sudo stat -c "%G %n" /etc/passwd 

root /etc/passwd

If "/etc/passwd" file does not have a group owner of "root", this is a finding.
Fix Text:
Change the group of the file /etc/passwd to root by running the following command:

$ sudo chgrp root /etc/passwd
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257908
Rule ID:
SV-257908r991589
STIG ID:
RHEL-09-232140
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/passwd- file must be owned by root.
Discussion:
The "/etc/passwd-" file is a backup file of "/etc/passwd", and as such, contains information about the users that are configured on the system. Protection of this file is critical for system security.
Check Text:
Verify the ownership of the "/etc/passwd-" file with the following command:

$ sudo stat -c "%U %n" /etc/passwd- 

root /etc/passwd- 

If "/etc/passwd-" file does not have an owner of "root", this is a finding.
Fix Text:
Change the owner of the file /etc/passwd- to root by running the following command:

$ sudo chown root /etc/passwd-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257909
Rule ID:
SV-257909r991589
STIG ID:
RHEL-09-232145
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/passwd- file must be group-owned by root.
Discussion:
The "/etc/passwd-" file is a backup file of "/etc/passwd", and as such, contains information about the users that are configured on the system. Protection of this file is critical for system security.
Check Text:
Verify the group ownership of the "/etc/passwd-" file with the following command:

$ sudo stat -c "%G %n" /etc/passwd-

root /etc/passwd-

If "/etc/passwd-" file does not have a group owner of "root", this is a finding.
Fix Text:
Change the group of the file /etc/passwd- to root by running the following command:

$ sudo chgrp root /etc/passwd-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257910
Rule ID:
SV-257910r991589
STIG ID:
RHEL-09-232150
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/shadow file must be owned by root.
Discussion:
The "/etc/shadow" file contains the list of local system accounts and stores password hashes. Protection of this file is critical for system security. Failure to give ownership of this file to root provides the designated owner with access to sensitive information, which could weaken the system security posture.
Check Text:
Verify the ownership of the "/etc/shadow" file with the following command:

$ sudo stat -c "%U %n" /etc/shadow

root /etc/shadow

If "/etc/shadow" file does not have an owner of "root", this is a finding.
Fix Text:
Change the owner of the file /etc/shadow to root by running the following command:

$ sudo chown root /etc/shadow
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257911
Rule ID:
SV-257911r991589
STIG ID:
RHEL-09-232155
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/shadow file must be group-owned by root.
Discussion:
The "/etc/shadow" file stores password hashes. Protection of this file is critical for system security.
Check Text:
Verify the group ownership of the "/etc/shadow" file with the following command:

$ sudo stat -c "%G %n" /etc/shadow 

root /etc/shadow

If "/etc/shadow" file does not have a group owner of "root", this is a finding.
Fix Text:
Change the group of the file /etc/shadow to root by running the following command:

$ sudo chgrp root /etc/shadow
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257912
Rule ID:
SV-257912r991589
STIG ID:
RHEL-09-232160
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/shadow- file must be owned by root.
Discussion:
The "/etc/shadow-" file is a backup file of "/etc/shadow", and as such, contains the list of local system accounts and password hashes. Protection of this file is critical for system security.
Check Text:
Verify the ownership of the "/etc/shadow-" file with the following command:

$ sudo stat -c "%U %n" /etc/shadow- 

root /etc/shadow- 

If "/etc/shadow-" file does not have an owner of "root", this is a finding.
Fix Text:
Change the owner of the file /etc/shadow- to root by running the following command:

$ sudo chown root /etc/shadow-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257913
Rule ID:
SV-257913r991589
STIG ID:
RHEL-09-232165
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/shadow- file must be group-owned by root.
Discussion:
The "/etc/shadow-" file is a backup file of "/etc/shadow", and as such, contains the list of local system accounts and password hashes. Protection of this file is critical for system security.
Check Text:
Verify the group ownership of the "/etc/shadow-" file with the following command:

$ sudo stat -c "%G %n" /etc/shadow-

root /etc/shadow-

If "/etc/shadow-" file does not have a group owner of "root", this is a finding.
Fix Text:
Change the group of the file /etc/shadow- to root by running the following command:

$ sudo chgrp root /etc/shadow-
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257926
Rule ID:
SV-257926r991589
STIG ID:
RHEL-09-232230
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 cron configuration files directory must be owned by root.
Discussion:
Service configuration files enable or disable features of their respective services that if configured incorrectly can lead to insecure and vulnerable configurations; therefore, service configuration files must be owned by the correct group to prevent unauthorized changes.
Check Text:
Verify the ownership of all cron configuration files with the command:

$ stat -c "%U %n" /etc/cron*

root /etc/cron.d
root /etc/cron.daily
root /etc/cron.deny
root /etc/cron.hourly
root /etc/cron.monthly
root /etc/crontab
root /etc/cron.weekly

If any crontab is not owned by root, this is a finding.
Fix Text:
Configure any cron configuration not owned by root with the following command:

$ sudo chown root [cron config file]
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257927
Rule ID:
SV-257927r991589
STIG ID:
RHEL-09-232235
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 cron configuration files directory must be group-owned by root.
Discussion:
Service configuration files enable or disable features of their respective services that if configured incorrectly can lead to insecure and vulnerable configurations; therefore, service configuration files should be owned by the correct group to prevent unauthorized changes.
Check Text:
Verify the group ownership of all cron configuration files with the following command:

$ stat -c "%G %n" /etc/cron*

root /etc/cron.d
root /etc/cron.daily
root /etc/cron.deny
root /etc/cron.hourly
root /etc/cron.monthly
root /etc/crontab
root /etc/cron.weekly

If any crontab is not group owned by root, this is a finding.
Fix Text:
Configure any cron configuration not group-owned by root with the following command:

$ sudo chgrp root [cron config file]
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257930
Rule ID:
SV-257930r991589
STIG ID:
RHEL-09-232250
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
All RHEL 9 local files and directories must have a valid group owner.
Discussion:
Files without a valid group owner may be unintentionally inherited if a group is assigned the same Group Identifier (GID) as the GID of the files without a valid group owner.
Check Text:
Verify all local files and directories on RHEL 9 have a valid group with the following command:

$ df --local -P | awk {'if (NR!=1) print $6'} | sudo xargs -I '{}' find '{}' -xdev -nogroup

If any files on the system do not have an assigned group, this is a finding.
Fix Text:
Either remove all files and directories from RHEL 9 that do not have a valid group, or assign a valid group to all files and directories on the system with the "chgrp" command:

$ sudo chgrp <group> <file>
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257931
Rule ID:
SV-257931r991589
STIG ID:
RHEL-09-232255
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
All RHEL 9 local files and directories must have a valid owner.
Discussion:
Unowned files and directories may be unintentionally inherited if a user is assigned the same user identifier "UID" as the UID of the unowned files.
Check Text:
Verify all local files and directories on RHEL 9 have a valid owner with the following command:

$ df --local -P | awk {'if (NR!=1) print $6'} | sudo xargs -I '{}' find '{}' -xdev -nouser

If any files on the system do not have an assigned owner, this is a finding.
Fix Text:
Either remove all files and directories from the system that do not have a valid user, or assign a valid user to all unowned files and directories on RHEL 9 with the "chown" command:

$ sudo chown <user> <file>
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257934
Rule ID:
SV-257934r991589
STIG ID:
RHEL-09-232270
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 /etc/shadow file must have mode 0000 to prevent unauthorized access.
Discussion:
The "/etc/shadow" file contains the list of local system accounts and stores password hashes. Protection of this file is critical for system security. Failure to give ownership of this file to root provides the designated owner with access to sensitive information, which could weaken the system security posture.
Check Text:
Verify that the "/etc/shadow" file has mode "0000" with the following command:

$ sudo stat -c "%a %n" /etc/shadow

0 /etc/shadow

If a value of "0" is not returned, this is a finding.
Fix Text:
Change the mode of the file "/etc/shadow" to "0000" by running the following command:

$ sudo chmod 0000 /etc/shadow
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257941
Rule ID:
SV-257941r991589
STIG ID:
RHEL-09-251040
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 network interfaces must not be in promiscuous mode.
Discussion:
Network interfaces in promiscuous mode allow for the capture of all network traffic visible to the system. If unauthorized individuals can access these applications, it may allow them to collect information such as logon IDs, passwords, and key exchanges between systems.

If the system is being used to perform a network troubleshooting function, the use of these tools must be documented with the information systems security officer (ISSO) and restricted to only authorized personnel.
Check Text:
Verify network interfaces are not in promiscuous mode with the following command:

$ ip link | grep -i promisc

If network interfaces are found on the system in promiscuous mode and their use has not been approved by the ISSO and documented, this is a finding.
Fix Text:
Configure network interfaces to turn off promiscuous mode unless approved by the ISSO and documented.

Set the promiscuous mode of an interface to off with the following command:

$ sudo ip link set dev <devicename> multicast off promisc off
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257955
Rule ID:
SV-257955r991589
STIG ID:
RHEL-09-252070
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT I
Classification
Unclassified
Rule Title:
There must be no shosts.equiv files on RHEL 9.
Discussion:
The shosts.equiv files are used to configure host-based authentication for the system via SSH. Host-based authentication is not sufficient for preventing unauthorized access to the system, as it does not require interactive identification and authentication of a connection request, or for the use of two-factor authentication.
Check Text:
Verify there are no "shosts.equiv" files on RHEL 9 with the following command:

$ sudo find / -name shosts.equiv

If a "shosts.equiv" file is found, this is a finding.
Fix Text:
Remove any found "shosts.equiv" files from the system.

$ sudo rm /[path]/[to]/[file]/shosts.equiv
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257956
Rule ID:
SV-257956r991589
STIG ID:
RHEL-09-252075
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT I
Classification
Unclassified
Rule Title:
There must be no .shosts files on RHEL 9.
Discussion:
The .shosts files are used to configure host-based authentication for individual users or the system via SSH. Host-based authentication is not sufficient for preventing unauthorized access to the system, as it does not require interactive identification and authentication of a connection request, or for the use of two-factor authentication.
Check Text:
Verify there are no ".shosts" files on RHEL 9 with the following command:

$ sudo find / -name .shosts

If a ".shosts" file is found, this is a finding.
Fix Text:
Remove any found ".shosts" files from the system.

$ sudo rm /[path]/[to]/[file]/.shosts
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257969
Rule ID:
SV-257969r991589
STIG ID:
RHEL-09-253070
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not allow interfaces to perform Internet Control Message Protocol (ICMP) redirects by default.
Discussion:
ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain information from the system's route table possibly revealing portions of the network topology.

The ability to send ICMP redirects is only appropriate for systems acting as routers.
Check Text:
Verify RHEL 9 does not allow interfaces to perform Internet Protocol version 4 (IPv4) ICMP redirects by default.

Check the value of the "default send_redirects" variables with the following command:

$ sudo sysctl net.ipv4.conf.default.send_redirects

net.ipv4.conf.default.send_redirects=0

If the returned line does not have a value of "0", or a line is not returned, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo /usr/lib/systemd/systemd-sysctl --cat-config | egrep -v '^(#|;)' | grep -F net.ipv4.conf.default.send_redirects | tail -1

net.ipv4.conf.default.send_redirects = 0

If "net.ipv4.conf.default.send_redirects" is not set to "0" and is not documented with the information system security officer (ISSO) as an operational requirement or is missing, this is a finding.
Fix Text:
Configure RHEL 9 to not allow interfaces to perform Internet Protocol version 4 (IPv4) ICMP redirects by default.

Add or edit the following line in a single system configuration file, in the "/etc/sysctl.d/" directory:

net.ipv4.conf.default.send_redirects = 0

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258001
Rule ID:
SV-258001r991589
STIG ID:
RHEL-09-255125
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH public host key files must have mode 0644 or less permissive.
Discussion:
If a public host key file is modified by an unauthorized user, the SSH service may be compromised.
Check Text:
Verify the SSH public host key files have a mode of "0644" or less permissive with the following command:

Note: SSH public key files may be found in other directories on the system depending on the installation.

$ sudo stat -c "%a %n" /etc/ssh/*.pub

644 /etc/ssh/ssh_host_dsa_key.pub
644 /etc/ssh/ssh_host_ecdsa_key.pub
644 /etc/ssh/ssh_host_ed25519_key.pub
644 /etc/ssh/ssh_host_rsa_key.pub

If any key.pub file has a mode more permissive than "0644", this is a finding.
Fix Text:
Change the mode of public host key files under "/etc/ssh" to "0644" with the following command:

$ sudo chmod 0644 /etc/ssh/*key.pub

Restart the SSH daemon for the changes to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258002
Rule ID:
SV-258002r991589
STIG ID:
RHEL-09-255130
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH daemon must not allow compression or must only allow compression after successful authentication.
Discussion:
If compression is allowed in an SSH connection prior to authentication, vulnerabilities in the compression software could result in compromise of the system from an unauthenticated connection, potentially with root privileges.
Check Text:
Verify the SSH daemon performs compression after a user successfully authenticates with the following command:

$ sudo /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*compression'

Compression delayed

If the "Compression" keyword is set to "yes", is missing, or the returned line is commented out, this is a finding.
Fix Text:
Configure the SSH daemon to not allow compression.

Uncomment the "Compression" keyword in "/etc/ssh/sshd_config" on the system and set the value to "delayed" or "no":

Compression no

The SSH service must be restarted for changes to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258028
Rule ID:
SV-258028r991589
STIG ID:
RHEL-09-271090
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 effective dconf policy must match the policy keyfiles.
Discussion:
Unlike text-based keyfiles, the binary database is impossible to check through most automated and all manual means; therefore, in order to evaluate dconf configuration, both have to be true at the same time - configuration files have to be compliant, and the database needs to be more recent than those keyfiles, which gives confidence that it reflects them.
Check Text:
Check the last modification time of the local databases, comparing it to the last modification time of the related keyfiles. The following command will check every dconf database and compare its modification time to the related system keyfiles:

Note: This requirement assumes the use of the RHEL 9 default graphical user interface, the GNOME desktop environment. If the system does not have any graphical user interface installed, this requirement is Not Applicable.

$ function dconf_needs_update { for db in $(find /etc/dconf/db -maxdepth 1 -type f); do db_mtime=$(stat -c %Y "$db"); keyfile_mtime=$(stat -c %Y "$db".d/* | sort -n | tail -1); if [ -n "$db_mtime" ] && [ -n "$keyfile_mtime" ] && [ "$db_mtime" -lt "$keyfile_mtime" ]; then echo "$db needs update"; return 1; fi; done; }; dconf_needs_update

If the command has any output, then a dconf database needs to be updated, and this is a finding.
Fix Text:
Update the dconf databases by running the following command:

$ sudo dconf update
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258043
Rule ID:
SV-258043r991589
STIG ID:
RHEL-09-411020
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
All RHEL 9 local interactive user accounts must be assigned a home directory upon creation.
Discussion:
If local interactive users are not assigned a valid home directory, there is no place for the storage and control of files they should own.
Check Text:
Verify all local interactive users on RHEL 9 are assigned a home directory upon creation with the following command:

$ grep -i create_home /etc/login.defs

CREATE_HOME yes

If the value for "CREATE_HOME" parameter is not set to "yes", the line is missing, or the line is commented out, this is a finding.
Fix Text:
Configure RHEL 9 to assign home directories to all new local interactive users by setting the "CREATE_HOME" parameter in "/etc/login.defs" to "yes" as follows.

CREATE_HOME yes
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258046
Rule ID:
SV-258046r991589
STIG ID:
RHEL-09-411035
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 system accounts must not have an interactive login shell.
Discussion:
Ensuring shells are not given to system accounts upon login makes it more difficult for attackers to make use of system accounts.
Check Text:
Verify that system accounts must not have an interactive login shell with the following command:

$ awk -F: '($3<1000){print $1 ":" $3 ":" $7}' /etc/passwd

root:0:/bin/bash
bin:1:/sbin/nologin
daemon:2:/sbin/nologin
adm:3:/sbin/nologin
lp:4:/sbin/nologin

Identify the system accounts from this listing that do not have a nologin shell.

If any system account (other than the root account) has a login shell and it is not documented with the information system security officer (ISSO), this is a finding.
Fix Text:
Configure RHEL 9 so that all noninteractive accounts on the system do not have an interactive shell assigned to them.

If the system account needs a shell assigned for mission operations, document the need with the information system security officer (ISSO).

Run the following command to disable the interactive shell for a specific noninteractive user account:

Replace <user> with the user that has a login shell.

$ sudo usermod --shell /sbin/nologin <user>

Do not perform the steps in this section on the root account. Doing so will cause the system to become inaccessible.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258051
Rule ID:
SV-258051r991589
STIG ID:
RHEL-09-411060
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
All RHEL 9 local interactive users must have a home directory assigned in the /etc/passwd file.
Discussion:
If local interactive users are not assigned a valid home directory, there is no place for the storage and control of files they should own.
Check Text:
Verify that interactive users on the system have a home directory assigned with the following command:
 
$ sudo awk -F: '($3>=1000)&&($7 !~ /nologin/){print $1, $3, $6}' /etc/passwd

smithk:x:1000:1000:smithk:/home/smithk:/bin/bash
scsaustin:x:1001:1001:scsaustin:/home/scsaustin:/bin/bash
djohnson:x:1002:1002:djohnson:/home/djohnson:/bin/bash

Inspect the output and verify that all interactive users (normally users with a user identifier (UID) greater that 1000) have a home directory defined.

If users home directory is not defined, this is a finding.
Fix Text:
Create and assign home directories to all local interactive users on RHEL 9 that currently do not have a home directory assigned.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258052
Rule ID:
SV-258052r991589
STIG ID:
RHEL-09-411065
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
All RHEL 9 local interactive user home directories defined in the /etc/passwd file must exist.
Discussion:
If a local interactive user has a home directory defined that does not exist, the user may be given access to the / directory as the current working directory upon logon. This could create a denial of service because the user would not be able to access their logon configuration files, and it may give them visibility to system files they normally would not be able to access.
Check Text:
Verify the assigned home directories of all interactive users on the system exist with the following command:

$ sudo pwck -r 

user 'mailnull': directory 'var/spool/mqueue' does not exist

The output should not return any interactive users.

If users home directory does not exist, this is a finding.
Fix Text:
Create home directories to all local interactive users that currently do not have a home directory assigned. Use the following commands to create the user home directory assigned in "/etc/ passwd":

Note: The example will be for the user wadea, who has a home directory of "/home/wadea", a user identifier (UID) of "wadea", and a Group Identifier (GID) of "users assigned" in "/etc/passwd".

$ sudo mkdir /home/wadea 
$ sudo chown wadea /home/wadea
$ sudo chgrp users /home/wadea
$ sudo chmod 0750 /home/wadea
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258053
Rule ID:
SV-258053r991589
STIG ID:
RHEL-09-411070
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
All RHEL 9 local interactive user home directories must be group-owned by the home directory owner's primary group.
Discussion:
If the Group Identifier (GID) of a local interactive users home directory is not the same as the primary GID of the user, this would allow unauthorized access to the users files, and users that share the same group may not be able to access files that they legitimately should.
Check Text:
Verify the assigned home directory of all local interactive users is group-owned by that user's primary GID with the following command:

Note: This may miss local interactive users that have been assigned a privileged user identifier (UID). Evidence of interactive use may be obtained from a number of log files containing system logon information. The returned directory "/home/wadea" is used as an example.

$ sudo ls -ld $(awk -F: '($3>=1000)&&($7 !~ /nologin/){print $6}' /etc/passwd)

drwxr-x--- 2 wadea admin 4096 Jun 5 12:41 wadea

Check the user's primary group with the following command:

$ sudo grep $(grep wadea /etc/passwd | awk -F: {print $4}') /etc/group

admin:x:250:wadea,jonesj,jacksons

If the user home directory referenced in "/etc/passwd" is not group-owned by that user's primary GID, this is a finding.
Fix Text:
Change the group owner of a local interactive user's home directory to the group found in "/etc/passwd". To change the group owner of a local interactive user's home directory, use the following command:

Note: The example will be for the user "wadea", who has a home directory of "/home/wadea", and has a primary group of users.

$ sudo chgrp users /home/wadea
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258059
Rule ID:
SV-258059r991589
STIG ID:
RHEL-09-411100
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT I
Classification
Unclassified
Rule Title:
The root account must be the only account having unrestricted access to RHEL 9 system.
Discussion:
An account has root authority if it has a user identifier (UID) of "0". Multiple accounts with a UID of "0" afford more opportunity for potential intruders to guess a password for a privileged account. Proper configuration of sudo is recommended to afford multiple system administrators access to root privileges in an accountable manner.
Check Text:
Verify that only the "root" account has a UID "0" assignment with the following command:

$ awk -F: '$3 == 0 {print $1}' /etc/passwd

root

If any accounts other than "root" have a UID of "0", this is a finding.
Fix Text:
Change the UID of any account on the system, other than root, that has a UID of "0". 

If the account is associated with system commands or applications, the UID should be changed to one greater than "0" but less than "1000". Otherwise, assign a UID of greater than "1000" that has not already been assigned.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258062
Rule ID:
SV-258062r991589
STIG ID:
RHEL-09-411115
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
Local RHEL 9 initialization files must not execute world-writable programs.
Discussion:
If user start-up files execute world-writable programs, especially in unprotected directories, they could be maliciously modified to destroy user files or otherwise compromise the system at the user level. If the system is compromised at the user level, it is easier to elevate privileges to eventually compromise the system at the root and network level.
Check Text:
Verify that local initialization files do not execute world-writable programs with the following command:

Note: The example will be for a system that is configured to create user home directories in the "/home" directory.

$ sudo find /home -perm -002 -type f -name ".[^.]*" -exec ls -ld {} \; 

If any local initialization files are found to reference world-writable files, this is a finding.
Fix Text:
Set the mode on files being executed by the local initialization files with the following command:

$ sudo chmod 0755 <file>
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258071
Rule ID:
SV-258071r991588
STIG ID:
RHEL-09-412050
SRG ID:
SRG-OS-000480-GPOS-00226
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must enforce a delay of at least four seconds between logon prompts following a failed logon attempt.
Discussion:
Increasing the time between a failed authentication attempt and reprompting to enter credentials helps to slow a single-threaded brute force attack.
Check Text:
Verify RHEL 9 enforces a delay of at least four seconds between console logon prompts following a failed logon attempt with the following command:

$ grep -i fail_delay /etc/login.defs

FAIL_DELAY 4

If the value of "FAIL_DELAY" is not set to "4" or greater, or the line is commented out, this is a finding.
Fix Text:
Configure the RHEL 9 to enforce a delay of at least four seconds between logon prompts following a failed console logon attempt.

Modify the "/etc/login.defs" file to set the "FAIL_DELAY" parameter to 4 or greater:

FAIL_DELAY 4
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258074
Rule ID:
SV-258074r991590
STIG ID:
RHEL-09-412065
SRG ID:
SRG-OS-000480-GPOS-00228
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must define default permissions for all authenticated users in such a way that the user can only read and modify their own files.
Discussion:
Setting the most restrictive default permissions ensures that when new accounts are created, they do not have unnecessary access.
Check Text:
Verify RHEL 9 defines default permissions for all authenticated users in such a way that the user can only read and modify their own files with the following command:

Note: If the value of the "UMASK" parameter is set to "000" in "/etc/login.defs" file, the Severity is raised to a CAT I.

# grep -i umask /etc/login.defs

UMASK 077

If the value for the "UMASK" parameter is not "077", or the "UMASK" parameter is missing or is commented out, this is a finding.
Fix Text:
Configure RHEL 9 to define default permissions for all authenticated users in such a way that the user can only read and modify their own files.

Add or edit the lines for the "UMASK" parameter in the "/etc/login.defs" file to "077":

UMASK 077
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258075
Rule ID:
SV-258075r991590
STIG ID:
RHEL-09-412070
SRG ID:
SRG-OS-000480-GPOS-00228
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must define default permissions for the system default profile.
Discussion:
The umask controls the default access mode assigned to newly created files. A umask of 077 limits new files to mode 600 or less permissive. Although umask can be represented as a four-digit number, the first digit representing special access modes is typically ignored or required to be "0". This requirement applies to the globally configured system defaults and the local interactive user defaults for each account on the system.

Satisfies: SRG-OS-000480-GPOS-00228, SRG-OS-000480-GPOS-00227
Check Text:
Verify the "umask" setting is configured correctly in the "/etc/profile" file with the following command:

Note: If the value of the "umask" parameter is set to "000" "/etc/profile" file, the Severity is raised to a CAT I.

$ grep umask /etc/profile 

umask 077

If the value for the "umask" parameter is not "077", or the "umask" parameter is missing or is commented out, this is a finding.
Fix Text:
Configure RHEL 9 to define default permissions for all authenticated users in such a way that the user can only read and modify their own files.

Add or edit the lines for the "umask" parameter in the "/etc/profile" file to "077":

umask 077
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258076
Rule ID:
SV-258076r991589
STIG ID:
RHEL-09-412075
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT III
Classification
Unclassified
Rule Title:
RHEL 9 must display the date and time of the last successful account logon upon logon.
Discussion:
Users need to be aware of activity that occurs regarding their account. Providing users with information regarding the number of unsuccessful attempts that were made to login to their account allows the user to determine if any unauthorized activity has occurred and gives them an opportunity to notify administrators.
Check Text:
Verify users are provided with feedback on when account accesses last occurred with the following command:

$ sudo grep pam_lastlog /etc/pam.d/postlogin

session required pam_lastlog.so showfailed

If "pam_lastlog" is missing from "/etc/pam.d/postlogin" file, or the silent option is present, this is a finding.
Fix Text:
Configure RHEL 9 to provide users with feedback on when account accesses last occurred by setting the required configuration options in "/etc/pam.d/postlogin". 

Add the following line to the top of "/etc/pam.d/postlogin":

session required pam_lastlog.so showfailed
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258120
Rule ID:
SV-258120r991589
STIG ID:
RHEL-09-611155
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not have accounts configured with blank or null passwords.
Discussion:
If an account has an empty password, anyone could log in and run commands with the privileges of that account. Accounts with empty passwords should never be used in operational environments.
Check Text:
Verify that null or blank passwords cannot be used with the following command:

$ sudo awk -F: '!$2 {print $1}' /etc/shadow

If the command returns any results, this is a finding.
Fix Text:
Configure all accounts on RHEL 9 to have a password or lock the account with the following commands:

Perform a password reset:

$ sudo passwd [username] 

To lock an account:

$ sudo passwd -l [username]
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258142
Rule ID:
SV-258142r991589
STIG ID:
RHEL-09-652020
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
The rsyslog service on RHEL 9 must be active.
Discussion:
The "rsyslog" service must be running to provide logging services, which are essential to system administration.
Check Text:
Verify that "rsyslog" is active with the following command:

$ systemctl is-active rsyslog 

active

If the rsyslog service is not active, this is a finding.
Fix Text:
To enable the rsyslog service, run the following command:

$ sudo systemctl enable --now rsyslog
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-258169
Rule ID:
SV-258169r991556
STIG ID:
RHEL-09-653100
SRG ID:
SRG-OS-000255-GPOS-00096
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must produce audit records containing information to establish the identity of any individual or process associated with the event.
Discussion:
Without establishing what type of events occurred, the source of events, where events occurred, and the outcome of events, it would be difficult to establish, correlate, and investigate the events leading up to an outage or attack.

Audit record content that may be necessary to satisfy this requirement includes, for example, time stamps, source and destination addresses, user/process identifiers, event descriptions, success/fail indications, filenames involved, and access control or flow control rules invoked.

Enriched logging aids in making sense of who, what, and when events occur on a system. Without this, determining root cause of an event will be much more difficult.

Satisfies: SRG-OS-000255-GPOS-00096, SRG-OS-000480-GPOS-00227
Check Text:
Verify that RHEL 9 audit system is configured to resolve audit information before writing to disk, with the following command:

$ sudo grep log_format /etc/audit/auditd.conf

log_format = ENRICHED

If the "log_format" option is not "ENRICHED", or the line is commented out, this is a finding.
Fix Text:
Edit the /etc/audit/auditd.conf file and add or update the "log_format" option:

log_format = ENRICHED

The audit daemon must be restarted for changes to take effect.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b
CCI-001487
Ensure that audit records containing information that establishes the identity of any individuals, subjects, or objects/entities associated with the event.
NIST SP 800-53 :: AU-3
NIST SP 800-53A :: AU-3.1
NIST SP 800-53 Revision 4 :: AU-3
NIST SP 800-53 Revision 5 :: AU-3 f

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-258170
Rule ID:
SV-258170r991589
STIG ID:
RHEL-09-653105
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must write audit records to disk.
Discussion:
Audit data should be synchronously written to disk to ensure log integrity. This setting assures that all audit event data is written disk.
Check Text:
Verify that the audit system is configured to write logs to the disk with the following command:

$ sudo grep write_logs /etc/audit/auditd.conf 

write_logs = yes 

If "write_logs" does not have a value of "yes", the line is commented out, or the line is missing, this is a finding.
Fix Text:
Configure the audit system to write log files to the disk.

Edit the /etc/audit/auditd.conf file and add or update the "write_logs" option to "yes":

write_logs = yes 

The audit daemon must be restarted for changes to take effect.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257788
Rule ID:
SV-257788r1044838
STIG ID:
RHEL-09-212015
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable the ability of systemd to spawn an interactive boot process.
Discussion:
Using interactive or recovery boot, the console user could disable auditing, firewalls, or other services, weakening system security.
Check Text:
Verify that GRUB 2 is configured to disable interactive boot.

Check that the current GRUB 2 configuration disables the ability of systemd to spawn an interactive boot process with the following command:

$ sudo grubby --info=ALL | grep args | grep 'systemd.confirm_spawn'

If any output is returned, this is a finding.
Fix Text:
Configure the current GRUB 2 configuration to disable the ability of systemd to spawn an interactive boot process with the following command:

$ sudo grubby --update-kernel=ALL --remove-args="systemd.confirm_spawn"
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257803
Rule ID:
SV-257803r1106429
STIG ID:
RHEL-09-213040
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable the kernel.core_pattern.
Discussion:
It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore, may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 disables storing core dumps with the following commands:

$ sudo sysctl kernel.core_pattern

kernel.core_pattern = |/bin/false

If the returned line does not have a value of "|/bin/false", or a line is not returned and the need for core dumps is not documented with the information system security officer (ISSO) as an operational requirement, this is a finding.

Check that the configuration files are present to enable this kernel parameter.

$ sudo grep -r kernel.core_pattern /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf:kernel.core_pattern = |/bin/false

If "kernel.core_pattern" is not set to "|/bin/false", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to disable storing core dumps.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

kernel.core_pattern = |/bin/false

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

The system configuration files must reloaded for the changes to take effect. To reload the contents of the files, run the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257812
Rule ID:
SV-257812r1051005
STIG ID:
RHEL-09-213085
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable core dump backtraces.
Discussion:
A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers or system operators trying to debug problems.

Enabling core dumps on production systems is not recommended; however, there may be overriding operational requirements to enable advanced debugging. Permitting temporary enablement of core dumps during such situations must be reviewed through local needs and policy.
Check Text:
Verify RHEL 9 disables core dump backtraces by issuing the following command:

$ grep -i ProcessSizeMax /etc/systemd/coredump.conf

ProcessSizeMax=0

If the "ProcessSizeMax" item is missing or commented out, or the value is anything other than "0", and the need for core dumps is not documented with the information system security officer (ISSO) as an operational requirement for all domains that have the "core" item assigned, this is a finding.
Fix Text:
Configure the operating system to disable core dump backtraces.

Add or modify the following line in /etc/systemd/coredump.conf:

ProcessSizeMax=0
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257816
Rule ID:
SV-257816r1106435
STIG ID:
RHEL-09-213105
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable the use of user namespaces.
Discussion:
It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore, may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 disables the use of user namespaces with the following commands:

$ sudo sysctl user.max_user_namespaces

user.max_user_namespaces = 0

If the returned line does not have a value of "0", or a line is not returned, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r user.max_user_namespaces /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: user.max_user_namespaces = 0

If "user.max_user_namespaces" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.

If the use of namespaces is operationally required and documented with the information system security manager (ISSM), it is not a finding.
Fix Text:
Configure RHEL 9 to disable the use of user namespaces by adding the following line to a file in the "/etc/sysctl.d" directory:

user.max_user_namespaces = 0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

The system configuration files must be reloaded for the changes to take effect. To reload the contents of the files, run the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257818
Rule ID:
SV-257818r1044876
STIG ID:
RHEL-09-213115
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
The kdump service on RHEL 9 must be disabled.
Discussion:
Kernel core dumps may contain the full contents of system memory at the time of the crash. Kernel core dumps consume a considerable amount of disk space and may result in denial of service by exhausting the available space on the target file system partition. Unless the system is used for kernel development or testing, there is little need to run the kdump service.
Check Text:
Verify that the kdump service is disabled in system boot configuration with the following command:

$ sudo systemctl is-enabled  kdump  

disabled 

Verify that the kdump service is not active (i.e., not running) through current runtime configuration with the following command:

$ sudo systemctl is-active kdump 

masked 

Verify that the kdump service is masked with the following command:

$ sudo systemctl show  kdump  | grep "LoadState\|UnitFileState" 

LoadState=masked 
UnitFileState=masked 

If the "kdump" service is loaded or active, and is not masked, this is a finding.
Fix Text:
Disable and mask the kdump service on RHEL 9.

To disable the kdump service run the following command:

$ sudo systemctl disable --now kdump

To mask the kdump service run the following command:

$ sudo systemctl mask --now kdump
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257823
Rule ID:
SV-257823r1051231
STIG ID:
RHEL-09-214030
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must be configured so that the cryptographic hashes of system files match vendor values.
Discussion:
The hashes of important files such as system executables should match the information given by the RPM database. Executables with erroneous hashes could be a sign of nefarious activity on the system.
Check Text:
Verify that RHEL 9 is configured so that the cryptographic hashes of system files match vendor values.
 
List files on the system that have file hashes different from what is expected by the RPM database with the following command:

$ sudo rpm -Va --noconfig | awk '$1 ~ /..5/ && $2 != "c"' 

If there is output, this is a finding.
Fix Text:
Configure RHEL 9 so that the cryptographic hashes of system files match vendor values.

Given output from the check command, identify the package that provides the output and reinstall it. The following trimmed example output shows a package that has failed verification, been identified, and been reinstalled:

$ sudo rpm -Va --noconfig | awk '$1 ~ /..5/ && $2 != "c"'
S.5....T.    /usr/bin/znew

$ sudo dnf provides /usr/bin/znew
[...]
gzip-1.10-8.el9.x86_64 : The GNU data compression program
[...]

$ sudo dnf -y reinstall gzip
[...]

$ sudo rpm -Va --noconfig | awk '$1 ~ /..5/ && $2 != "c"'
[no output]
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257835
Rule ID:
SV-257835r1102037
STIG ID:
RHEL-09-215060
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT I
Classification
Unclassified
Rule Title:
RHEL 9 must not have a Trivial File Transfer Protocol (TFTP) server package installed.
Discussion:
Removing the "tftp-server" package decreases the risk of the accidental (or intentional) activation of tftp services.

If TFTP is required for operational support (such as transmission of router configurations), its use must be documented with the information systems security manager (ISSM), restricted to only authorized personnel, and have access control rules established.
Check Text:
Verify that RHEL 9 does not have a "tftp-server" package installed with the following command:

$ sudo dnf list --installed tftp-server

Error: No matching Packages to list

If the "tftp-server" package is installed, this is a finding.
Fix Text:
The "tftp-server" package can be removed with the following command:

$ sudo dnf remove tftp-server
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257836
Rule ID:
SV-257836r1044908
STIG ID:
RHEL-09-215065
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not have the quagga package installed.
Discussion:
Quagga is a network routing software suite providing implementations of Open Shortest Path First (OSPF), Routing Information Protocol (RIP), Border Gateway Protocol (BGP) for Unix and Linux platforms.

If there is no need to make the router software available, removing it provides a safeguard against its activation.
Check Text:
Verify that the quagga package is not installed with the following command:

$ dnf list --installed quagga

Error: No matching Packages to list

If the "quagga" package is installed and is not documented with the information system security officer (ISSO) as an operational requirement, this is a finding.
Fix Text:
Remove the quagga package with the following command:

$ sudo dnf remove quagga
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257837
Rule ID:
SV-257837r1044910
STIG ID:
RHEL-09-215070
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
A graphical display manager must not be installed on RHEL 9 unless approved.
Discussion:
Unnecessary service packages must not be installed to decrease the attack surface of the system. Graphical display managers have a long history of security vulnerabilities and must not be used, unless approved and documented.
Check Text:
Verify that a graphical user interface is not installed with the following command:

$ dnf list --installed "xorg-x11-server-common"
Error: No matching Packages to list

If the "xorg-x11-server-common" package is installed, and the use of a graphical user interface has not been documented with the information system security officer (ISSO) as an operational requirement, this is a finding.
Fix Text:
Document the requirement for a graphical user interface with the ISSO or remove all xorg packages with the following command:

Warning: If you are accessing the system through the graphical user interface, change to the multi-user.target with the following command:

$ sudo systemctl isolate multi-user.target

Warning: Removal of the graphical user interface will immediately render it useless. The following commands must not be run from a virtual terminal emulator in the graphical interface.

$ sudo dnf remove "xorg*"
$ sudo systemctl set-default multi-user.target
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257841
Rule ID:
SV-257841r1044914
STIG ID:
RHEL-09-215090
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must have the rng-tools package installed.
Discussion:
"rng-tools" provides hardware random number generator tools, such as those used in the formation of x509/PKI certificates.
Check Text:
Verify that RHEL 9 has the rng-tools package installed with the following command:

$ dnf list --installed rng-tools

Example output:

rng-tools.x86_64          6.14-2.git.b2b7934e.el9

If the "rng-tools" package is not installed, this is a finding.
Fix Text:
The rng-tools package can be installed with the following command:
 
$ sudo dnf install rng-tools
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257844
Rule ID:
SV-257844r1044918
STIG ID:
RHEL-09-231015
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must use a separate file system for /tmp.
Discussion:
The "/tmp" partition is used as temporary storage by many programs. Placing "/tmp" in its own partition enables the setting of more restrictive mount options, which can help protect programs that use it.
Check Text:
Verify that a separate file system/partition has been created for "/tmp" with the following command:

$ mount | grep /tmp 

/dev/mapper/rhel-tmp on /tmp type xfs (rw,nodev,nosuid,noexec,seclabel)

If a separate entry for "/tmp" is not in use, this is a finding.
Fix Text:
Migrate the "/tmp" path onto a separate file system.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257845
Rule ID:
SV-257845r1044920
STIG ID:
RHEL-09-231020
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT III
Classification
Unclassified
Rule Title:
RHEL 9 must use a separate file system for /var.
Discussion:
Ensuring that "/var" is mounted on its own partition enables the setting of more restrictive mount options. This helps protect system services such as daemons or other programs which use it. It is not uncommon for the "/var" directory to contain world-writable directories installed by other software packages.
Check Text:
Verify that a separate file system/partition has been created for "/var" with the following command:

$ mount | grep /var

/dev/mapper/rootvg-varlv on /var type xfs (rw,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k,noquota)
Note: Options displayed for mount may differ.

If a separate entry for "/var" is not in use, this is a finding.
Fix Text:
Migrate the "/var" path onto a separate file system.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257846
Rule ID:
SV-257846r1044922
STIG ID:
RHEL-09-231025
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT III
Classification
Unclassified
Rule Title:
RHEL 9 must use a separate file system for /var/log.
Discussion:
Placing "/var/log" in its own partition enables better separation between log files and other files in "/var/".
Check Text:
Verify that a separate file system/partition has been created for "/var/log" with the following command:

$ mount | grep /var/log

/dev/mapper/rhel-var_log on /var/log type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k)
Note: Options displayed for mount may differ.

If a separate entry for "/var/log" is not in use, this is a finding.
Fix Text:
Migrate the "/var/log" path onto a separate file system.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257848
Rule ID:
SV-257848r1044926
STIG ID:
RHEL-09-231035
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must use a separate file system for /var/tmp.
Discussion:
The "/var/tmp" partition is used as temporary storage by many programs. Placing "/var/tmp" in its own partition enables the setting of more restrictive mount options, which can help protect programs that use it.
Check Text:
Verify that a separate file system/partition has been created for "/var/tmp" with the following command:

$ mount | grep /var/tmp

/dev/mapper/rhel-tmp on /var/tmp type xfs (rw,nosuid,nodev,noexec,relatime,seclabel,attr2,inode64,logbufs=8,logbsize=32k)
Note: Options displayed for mount may differ.

If a separate entry for "/var/tmp" is not in use, this is a finding.
Fix Text:
Migrate the "/var/tmp" path onto a separate file system.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257854
Rule ID:
SV-257854r1044934
STIG ID:
RHEL-09-231065
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent special devices on file systems that are imported via Network File System (NFS).
Discussion:
The "nodev" mount option causes the system to not interpret character or block special devices. Executing character or block special devices from untrusted file systems increases the opportunity for nonprivileged users to attain unauthorized administrative access.
Check Text:
Note: If no NFS mounts are configured, this requirement is Not Applicable.

Verify RHEL 9 has the "nodev" option configured for all NFS mounts with the following command:

$ grep nfs /etc/fstab

192.168.22.2:/mnt/export /data nfs4 rw,nosuid,nodev,noexec,sync,soft,sec=krb5:krb5i:krb5p

If the system is mounting file systems via NFS and the "nodev" option is missing, this is a finding.
Fix Text:
Update each NFS mounted file system to use the "nodev" option on file systems that are being imported via NFS.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257855
Rule ID:
SV-257855r1044936
STIG ID:
RHEL-09-231070
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9  must prevent code from being executed on file systems that are imported via Network File System (NFS).
Discussion:
The "noexec" mount option causes the system not to execute binary files. This option must be used for mounting any file system not containing approved binary as they may be incompatible. Executing files from untrusted file systems increases the opportunity for nonprivileged users to attain unauthorized administrative access.
Check Text:
Note: If no NFS mounts are configured, this requirement is Not Applicable.

Verify RHEL 9 has the "noexec" option configured for all NFS mounts with the following command:

$ grep nfs /etc/fstab

192.168.22.2:/mnt/export /data nfs4 rw,nosuid,nodev,noexec,sync,soft,sec=krb5:krb5i:krb5p

If the system is mounting file systems via NFS and the "noexec" option is missing, this is a finding.
Fix Text:
Update each NFS mounted file system to use the "noexec" option on file systems that are being imported via NFS.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257856
Rule ID:
SV-257856r1044938
STIG ID:
RHEL-09-231075
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent files with the setuid and setgid bit set from being executed on file systems that are imported via Network File System (NFS).
Discussion:
The "nosuid" mount option causes the system not to execute "setuid" and "setgid" files with owner privileges. This option must be used for mounting any file system not containing approved "setuid" and "setguid" files. Executing files from untrusted file systems increases the opportunity for nonprivileged users to attain unauthorized administrative access.
Check Text:
Note: If no NFS mounts are configured, this requirement is Not Applicable.

Verify RHEL 9 has the "nosuid" option configured for all NFS mounts with the following command:

$ grep nfs /etc/fstab

192.168.22.2:/mnt/export /data nfs4 rw,nosuid,nodev,noexec,sync,soft,sec=krb5:krb5i:krb5p

If the system is mounting file systems via NFS and the "nosuid" option is missing, this is a finding.
Fix Text:
Update each NFS mounted file system to use the "nosuid" option on file systems that are being imported via NFS.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257888
Rule ID:
SV-257888r1069378
STIG ID:
RHEL-09-232040
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 permissions of cron configuration files and directories must not be modified from the operating system defaults.
Discussion:
If the permissions of cron configuration files or directories are modified from the operating system defaults, it may be possible for individuals to insert unauthorized cron jobs that perform unauthorized actions, including potentially escalating privileges.
Check Text:
Run the following command to verify that the owner, group, and mode of cron configuration files and directories match the operating system defaults:

$ rpm --verify cronie crontabs | awk '! ($2 == "c" && $1 ~ /^.\..\.\.\.\..\./) {print $0}'

If the command returns any output, this is a finding.
Fix Text:
Run the following commands to restore the permissions of cron configuration files and directories to the operating system defaults:

$ sudo dnf reinstall cronie crontabs
$ rpm --setugids cronie crontabs
$ rpm --setperms cronie crontabs
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257889
Rule ID:
SV-257889r1044959
STIG ID:
RHEL-09-232045
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
All RHEL 9 local initialization files must have mode 0740 or less permissive.
Discussion:
Local initialization files are used to configure the user's shell environment upon logon. Malicious modification of these files could compromise accounts upon logon.
Check Text:
Verify that all local initialization files have a mode of "0740" or less permissive with the following command:
	
Note: The example will be for the "bingwa" user, who has a home directory of "/home/bingwa".
	
$ find /home/bingwa/.[^.]* -maxdepth 0 -perm -740 -exec stat -c "%a %n" {} \; | more

755 /home/bingwa/.somepermissivefile
	
If any local initialization files are returned, this indicates a mode more permissive than "0740", and this is a finding.
Fix Text:
Set the mode of the local initialization files to "0740" with the following command:

Note: The example will be for the wadea user, who has a home directory of "/home/wadea".

$ sudo chmod 0740 /home/wadea/.<INIT_FILE>
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257890
Rule ID:
SV-257890r1044961
STIG ID:
RHEL-09-232050
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
All RHEL 9 local interactive user home directories must have mode 0750 or less permissive.
Discussion:
Excessive permissions on local interactive user home directories may allow unauthorized access to user files by other users.
Check Text:
Verify the assigned home directory of all local interactive users has a mode of "0750" or less permissive with the following command:

Note: This may miss interactive users that have been assigned a privileged user identifier (UID). Evidence of interactive use may be obtained from a number of log files containing system logon information.

$ stat -L -c '%a %n' $(awk -F: '($3>=1000)&&($7 !~ /nologin/){print $6}' /etc/passwd) 2>/dev/null

700 /home/bingwa

If home directories referenced in "/etc/passwd" do not have a mode of "0750" or less permissive, this is a finding.
Fix Text:
Change the mode of interactive user's home directories to "0750". To change the mode of a local interactive user's home directory, use the following command:

Note: The example will be for the user "wadea".

$ sudo chmod 0750 /home/wadea
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257932
Rule ID:
SV-257932r1014838
STIG ID:
RHEL-09-232260
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must be configured so that all system device files are correctly labeled to prevent unauthorized modification.
Discussion:
If an unauthorized or modified device is allowed to exist on the system, there is the possibility the system may perform unintended or unauthorized operations.
Check Text:
Verify that all system device files are correctly labeled to prevent unauthorized modification.

List all device files on the system that are incorrectly labeled with the following commands:

Note: Device files are normally found under "/dev", but applications may place device files in other directories and may necessitate a search of the entire system.

# find /dev -context *:device_t:* \( -type c -o -type b \) -printf "%p %Z\n"

# find /dev -context *:unlabeled_t:* \( -type c -o -type b \) -printf "%p %Z\n"

Note: There are device files, such as "/dev/vmci", that are used when the operating system is a host virtual machine. They will not be owned by a user on the system and require the "device_t" label to operate. These device files are not a finding.

If there is output from either of these commands, other than already noted, this is a finding.
Fix Text:
Restore the SELinux policy for the affected device file from the system policy database using the following command:

$ sudo restorecon -v <device_path>

Substitute "<device_path>" with the path to the affected device file (from the output of the previous commands). An example device file path would be "/dev/ttyUSB0". If the output of the above command does not indicate that the device was relabeled to a more specific SELinux type label, then the SELinux policy of the system must be updated with more specific policy for the device class specified. If a package was used to install support for a device class, that package could be reinstalled using the following command:

$ sudo dnf reinstall <package_name>

If a package was not used to install the SELinux policy for a given device class, then it must be generated manually and provide specific type labels.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257937
Rule ID:
SV-257937r1106310
STIG ID:
RHEL-09-251020
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
The RHEL 9 firewall must employ a deny-all, allow-by-exception policy for allowing connections to other systems.
Discussion:
Failure to restrict network connectivity only to authorized systems permits inbound connections from malicious systems. It also permits outbound connections that may facilitate exfiltration of DOD data.

RHEL 9 incorporates the "firewalld" daemon, which allows for many different configurations. One of these configurations is zones. Zones can be utilized to a deny-all, allow-by-exception approach. The default "drop" zone will drop all incoming network packets unless it is explicitly allowed by the configuration file or is related to an outgoing network connection.
Check Text:
Verify the RHEL 9 firewalld is configured to employ a deny-all, allow-by-exception policy for allowing connections to other systems with the following commands:

Ensure firewalld is running:
$ sudo firewall-cmd --state
running

Identify active zones:
$ sudo firewall-cmd --get-active-zones
drop
  interfaces: ens192

Check what rules are applied in that zone:
$ sudo firewall-cmd --list-all --zone=$(firewall-cmd --get-default-zone)
drop (active)
  target: DROP
  icmp-block-inversion: no
  interfaces: ens192
  sources:
  services: ssh
  ports:
  protocols:
  forward: yes
  masquerade: no
  forward-ports:
  source-ports:
  icmp-blocks:
  rich rules:

If no zones are active on the RHEL 9 interfaces or if runtime and permanent targets are set to a different option other than "DROP", this is a finding.
Fix Text:
Configure the "firewalld" daemon to employ a deny-all, allow-by-exception policy with the following commands:

Start by adding the exceptions that are required for mission functionality to the "drop" zone. If SSH access on port 22 is needed, for example, run the following: "sudo firewall-cmd --permanent --add-service=ssh --zone=drop"

Reload the firewall rules to update the runtime configuration from the "--permanent" changes made above:
$ sudo firewall-cmd --reload

Set the default zone to the drop zone:
$ sudo firewall-cmd --set-default-zone=drop
Note: This is a runtime and permanent change.

Add any interfaces to the newly modified "drop" zone:
$ sudo firewall-cmd --permanent --zone=drop --change-interface=ens192

Reload the firewall rules for changes to take effect:
$ sudo firewall-cmd --reload
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257942
Rule ID:
SV-257942r1106314
STIG ID:
RHEL-09-251045
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must enable hardening for the Berkeley Packet Filter just-in-time compiler.
Discussion:
It is detrimental for operating systems to provide, or install by default, functionality exceeding requirements or mission objectives. These unnecessary capabilities or services are often overlooked and therefore may remain unsecured. They increase the risk to the platform by providing additional attack vectors.

Enabling hardening for the Berkeley Packet Filter (BPF) Just-in-time (JIT) compiler aids in mitigating JIT spraying attacks. Setting the value to "2" enables JIT hardening for all users.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 enables hardening for the BPF JIT with the following commands:

$ sudo sysctl net.core.bpf_jit_harden

net.core.bpf_jit_harden = 2

If the returned line does not have a value of "2", or a line is not returned, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.core.bpf_jit_harden /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.core.bpf_jit_harden = 2

If "net.core.bpf_jit_harden" is not set to "2", is missing or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to enable hardening for the BPF JIT compiler by adding the following line to a file, in the "/etc/sysctl.d" directory:

net.core.bpf_jit_harden = 2

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

The system configuration files must be reloaded for the changes to take effect. To reload the contents of the files, run the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257948
Rule ID:
SV-257948r1045004
STIG ID:
RHEL-09-252035
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 systems using Domain Name Servers (DNS) resolution must have at least two name servers configured.
Discussion:
To provide availability for name resolution services, multiple redundant name servers are mandated. A failure in name resolution could lead to the failure of security functions requiring name resolution, which may include time synchronization, centralized authentication, and remote system logging.
Check Text:
Note: If the system is running in a cloud platform and the cloud provider gives a single, highly available IP address for DNS configuration, this control is Not Applicable.

Verify the name servers used by the system with the following command:

$ grep nameserver /etc/resolv.conf

nameserver 192.168.1.2
nameserver 192.168.1.3

If fewer than two lines are returned that are not commented out, this is a finding.
Fix Text:
Configure the operating system to use two or more name servers for DNS resolution based on the DNS mode of the system.
	
If the NetworkManager DNS mode is set to "none", add the following lines to "/etc/resolv.conf":
	
nameserver [name server 1]
nameserver [name server 2]
	
Replace [name server 1] and [name server 2] with the IPs of two different DNS resolvers.
	
If the NetworkManager DNS mode is set to "default", add two DNS servers to a NetworkManager connection using the following command:
	
$ nmcli connection modify [connection name] ipv4.dns [name server 1],[name server 2]
	
Replace [name server 1] and [name server 2] with the IPs of two different DNS resolvers. Replace [connection name] with a valid NetworkManager connection name on the system. Replace ipv4 with ipv6 if IPv6 DNS servers are used.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257949
Rule ID:
SV-257949r1014841
STIG ID:
RHEL-09-252040
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must configure a DNS processing mode in Network Manager.
Discussion:
In order to ensure that DNS resolver settings are respected, a DNS mode in Network Manager must be configured.
Check Text:
Verify that RHEL 9 has a DNS mode configured in Network Manager.

$ NetworkManager --print-config
[main]
dns=none

If the dns key under main does not exist or is not set to "none" or "default", this is a finding.

Note: If RHEL 9 is configured to use a DNS resolver other than Network Manager, the configuration must be documented and approved by the information system security officer (ISSO).
Fix Text:
Configure NetworkManager in RHEL 9 to use a DNS mode.

In "/etc/NetworkManager/NetworkManager.conf" add the following line in the "[main]" section:

dns = none

NetworkManager must be reloaded for the change to take effect.

$ sudo systemctl reload NetworkManager
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257950
Rule ID:
SV-257950r1045006
STIG ID:
RHEL-09-252045
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not have unauthorized IP tunnels configured.
Discussion:
IP tunneling mechanisms can be used to bypass network filtering. If tunneling is required, it must be documented with the information system security officer (ISSO).
Check Text:
Verify that RHEL 9 does not have unauthorized IP tunnels configured.

Determine if the "IPsec" service is active with the following command:

$ systemctl is-active ipsec

Inactive

If the "IPsec" service is active, check for configured IPsec connections ("conn"), with the following command:

$ sudo grep -rni conn /etc/ipsec.conf /etc/ipsec.d/ 

Verify any returned results are documented with the ISSO.

If the IPsec tunnels are active and not approved, this is a finding.
Fix Text:
Remove all unapproved tunnels from the system, or document them with the ISSO.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257951
Rule ID:
SV-257951r1014843
STIG ID:
RHEL-09-252050
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must be configured to prevent unrestricted mail relaying.
Discussion:
If unrestricted mail relaying is permitted, unauthorized senders could use this host as a mail relay for the purpose of sending spam or other unauthorized activity.
Check Text:
If postfix is not installed, this is Not Applicable.

Verify RHEL 9 is configured to prevent unrestricted mail relaying with the following command:

$ postconf -n smtpd_client_restrictions 

smtpd_client_restrictions = permit_mynetworks,reject 

If the "smtpd_client_restrictions" parameter contains any entries other than "permit_mynetworks" and "reject", and the additional entries have not been documented with the information system security officer (ISSO), this is a finding.
Fix Text:
Modify the postfix configuration file to restrict client connections to the local network with the following command:

$ sudo postconf -e 'smtpd_client_restrictions = permit_mynetworks,reject'
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257958
Rule ID:
SV-257958r1106319
STIG ID:
RHEL-09-253015
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must ignore Internet Protocol version 4 (IPv4) Internet Control Message Protocol (ICMP) redirect messages.
Discussion:
ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 ignores IPv4 ICMP redirect messages.

Check the value of the "accept_redirects" variables with the following command:

$ sudo sysctl net.ipv4.conf.all.accept_redirects

net.ipv4.conf.all.accept_redirects = 0

If the returned line does not have a value of "0", a line is not returned, or the line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.conf.all.accept_redirects /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv4.conf.all.accept_redirects = 0

If "net.ipv4.conf.all.accept_redirects" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to ignore IPv4 ICMP redirect messages.

Add or edit the following line in a system configuration file, in the "/etc/sysctl.d/" directory:

net.ipv4.conf.all.accept_redirects = 0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257959
Rule ID:
SV-257959r1102024
STIG ID:
RHEL-09-253020
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not forward Internet Protocol version 4 (IPv4) source-routed packets.
Discussion:
Source-routed packets allow the source of the packet to suggest that routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures. This requirement applies only to the forwarding of source-routed traffic, such as when forwarding is enabled and the system is functioning as a router.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of which of the directories they reside in. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 does not accept IPv4 source-routed packets.

Check the value of the accept source route variable with the following command:

$ sudo sysctl net.ipv4.conf.all.accept_source_route

net.ipv4.conf.all.accept_source_route = 0

If the returned line does not have a value of "0", a line is not returned, or the line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.conf.all.accept_source_route /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv4.conf.all.accept_source_route = 0

If "net.ipv4.conf.all.accept_source_route" is not set to "0", is missing or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not forward IPv4 source-routed packets.

Add or edit the following line in a system configuration file, in the "/etc/sysctl.d/" directory:

net.ipv4.conf.all.accept_source_route=0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================


Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025
Group ID:
V-257960
Rule ID:
SV-257960r1106321
STIG ID:
RHEL-09-253025
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must log IPv4 packets with impossible addresses.
Discussion:
The presence of "martian" packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.

Preventing unauthorized information transfers mitigates the risk of information, including encrypted representations of information, produced by the actions of prior users/roles (or the actions of processes acting on behalf of prior users/roles) from being available to any current users/roles (or current processes) that obtain access to shared system resources (e.g., registers, main memory, hard disks) after those resources have been released back to information systems. The control of information in shared resources is also commonly referred to as object reuse and residual information protection.

This requirement generally applies to the design of an information technology product, but it can also apply to the configuration of particular information system components that are, or use, such products. This can be verified by acceptance/validation processes in DOD or other government agencies.

There may be shared resources with configurable protections (e.g., files in storage) that may be assessed on specific information system components.

Restricting access to the kernel message buffer limits access to only root. This prevents attackers from gaining additional system information as a nonprivileged user.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 logs IPv4 martian packets.

Check the value of the accept source route variable with the following command:

$ sudo sysctl net.ipv4.conf.all.log_martians

net.ipv4.conf.all.log_martians = 1

If the returned line does not have a value of "1", a line is not returned, or the line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.conf.all.log_martians /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf:net.ipv4.conf.all.log_martians = 1

If "net.ipv4.conf.all.log_martians" is not set to "1" or is missing, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to log martian packets on IPv4 interfaces.

Add or edit the following line in a single system configuration file in the "/etc/sysctl.d/" directory:

net.ipv4.conf.all.log_martians=1

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257961
Rule ID:
SV-257961r1106323
STIG ID:
RHEL-09-253030
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must log IPv4 packets with impossible addresses by default.
Discussion:
The presence of "martian" packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected.

Preventing unauthorized information transfers mitigates the risk of information, including encrypted representations of information, produced by the actions of prior users/roles (or the actions of processes acting on behalf of prior users/roles) from being available to any current users/roles (or current processes) that obtain access to shared system resources (e.g., registers, main memory, hard disks) after those resources have been released back to information systems. The control of information in shared resources is also commonly referred to as object reuse and residual information protection.

This requirement generally applies to the design of an information technology product, but it can also apply to the configuration of particular information system components that are, or use, such products. This can be verified by acceptance/validation processes in DOD or other government agencies.

There may be shared resources with configurable protections (e.g., files in storage) that may be assessed on specific information system components.

Restricting access to the kernel message buffer limits access to only root. This prevents attackers from gaining additional system information as a nonprivileged user.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 logs IPv4 martian packets by default.

Check the value of the accept source route variable with the following command:

$ sudo sysctl net.ipv4.conf.default.log_martians

net.ipv4.conf.default.log_martians = 1

If the returned line does not have a value of "1", a line is not returned, or the line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.conf.default.log_martians /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf:net.ipv4.conf.default.log_martians = 1

If "net.ipv4.conf.default.log_martians" is not set to "1" or is missing, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to log martian packets on IPv4 interfaces by default.

Add or edit the following line in a single system configuration file in the "/etc/sysctl.d/" directory:

net.ipv4.conf.default.log_martians = 1

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257962
Rule ID:
SV-257962r1106437
STIG ID:
RHEL-09-253035
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must use reverse path filtering on all IPv4 interfaces.
Discussion:
Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface on which they were received. It must not be used on systems that are routers for complicated networks, but is helpful for end hosts and routers serving small networks.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 uses reverse path filtering on all IPv4 interfaces with the following commands:

$ sudo sysctl net.ipv4.conf.all.rp_filter

net.ipv4.conf.all.rp_filter = 1

If the returned line does not have a value of "1" or "2", or a line is not returned, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.conf.all.rp_filter /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv4.conf.all.rp_filter = 1

If "net.ipv4.conf.all.rp_filter" is not set to "1" or "2", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to use reverse path filtering on all IPv4 interfaces by adding the following line to a file in the "/etc/sysctl.d" directory:

net.ipv4.conf.all.rp_filter = 1

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

The system configuration files must be reloaded for the changes to take effect. To reload the contents of the files, run the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257963
Rule ID:
SV-257963r1106328
STIG ID:
RHEL-09-253040
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent IPv4 Internet Control Message Protocol (ICMP) redirect messages from being accepted.
Discussion:
ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.

This feature of the IPv4 protocol has few legitimate uses. It must be disabled unless absolutely required.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 will not accept IPv4 ICMP redirect messages.

Check the value of the default "accept_redirects" variables with the following command:

$ sudo sysctl net.ipv4.conf.default.accept_redirects

net.ipv4.conf.default.accept_redirects = 0

If the returned line does not have a value of "0", a line is not returned, or the line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.conf.default.accept_redirects /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv4.conf.default.accept_redirects = 0

If "net.ipv4.conf.default.accept_redirects" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to prevent IPv4 ICMP redirect messages from being accepted.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv4.conf.default.accept_redirects = 0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257964
Rule ID:
SV-257964r1106438
STIG ID:
RHEL-09-253045
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not forward IPv4 source-routed packets by default.
Discussion:
Source-routed packets allow the source of the packet to suggest routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures. This requirement applies only to the forwarding of source-routed traffic, such as when forwarding is enabled and the system is functioning as a router.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 does not accept IPv4 source-routed packets by default.

Check the value of the accept source route variable with the following command:

$ sudo sysctl net.ipv4.conf.default.accept_source_route

net.ipv4.conf.default.accept_source_route = 0

If the returned line does not have a value of "0", a line is not returned, or the line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.conf.default.accept_source_route /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv4.conf.default.accept_source_route = 0

If "net.ipv4.conf.default.accept_source_route" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not forward IPv4 source-routed packets by default.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv4.conf.default.accept_source_route=0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257965
Rule ID:
SV-257965r1106333
STIG ID:
RHEL-09-253050
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must use a reverse-path filter for IPv4 network traffic when possible by default.
Discussion:
Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface on which they were received. It must not be used on systems that are routers for complicated networks, but is helpful for end hosts and routers serving small networks.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 uses reverse path filtering on IPv4 interfaces with the following commands:

$ sudo sysctl net.ipv4.conf.default.rp_filter

net.ipv4.conf.default.rp_filter = 1

If the returned line does not have a value of "1", or a line is not returned, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.conf.default.rp_filter /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf:net.ipv4.conf.default.rp_filter = 1

If "net.ipv4.conf.default.rp_filter" is not set to "1" or is missing, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to use reverse path filtering on IPv4 interfaces by default.

Add or edit the following line in a single system configuration file in the "/etc/sysctl.d/" directory:

net.ipv4.conf.default.rp_filter = 1

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257966
Rule ID:
SV-257966r1106440
STIG ID:
RHEL-09-253055
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not respond to Internet Control Message Protocol (ICMP) echoes sent to a broadcast address.
Discussion:
Responding to broadcast (ICMP) echoes facilitates network mapping and provides a vector for amplification attacks.

Ignoring ICMP echo requests (pings) sent to broadcast or multicast addresses makes the system slightly more difficult to enumerate on the network.

There are notable differences between Internet Protocol version 4 (IPv4) and Internet Protocol version 6 (IPv6). IPv6 does not implement the same method of broadcast as IPv4. Instead, IPv6 uses multicast addressing to the all-hosts multicast group. Refer to RFC4294 for an explanation of "IPv6 Node Requirements", which resulted in this difference between IPv4 and IPv6.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 does not respond to ICMP echoes sent to a broadcast address.

Check the value of the "icmp_echo_ignore_broadcasts" variable with the following command:

$ sudo sysctl net.ipv4.icmp_echo_ignore_broadcasts

net.ipv4.icmp_echo_ignore_broadcasts = 1

If the returned line does not have a value of "1", a line is not returned, or the retuned line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.icmp_echo_ignore_broadcasts /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv4.icmp_echo_ignore_broadcasts = 1

If "net.ipv4.icmp_echo_ignore_broadcasts" is not set to "1", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not respond to IPv4 ICMP echoes sent to a broadcast address.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv4.icmp_echo_ignore_broadcasts=1

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257967
Rule ID:
SV-257967r1106337
STIG ID:
RHEL-09-253060
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must limit the number of bogus Internet Control Message Protocol (ICMP) response errors logs.
Discussion:
Some routers will send responses to broadcast frames that violate RFC-1122, which fills up a log file system with many useless error messages. An attacker may take advantage of this and attempt to flood the logs with bogus error logs. Ignoring bogus ICMP error responses reduces log size, although some activity would not be logged.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
The runtime status of the net.ipv4.icmp_ignore_bogus_error_responses kernel parameter can be queried by running the following command:

$ sudo sysctl net.ipv4.icmp_ignore_bogus_error_responses 

net.ipv4.icmp_ignore_bogus_error_responses = 1

If "net.ipv4.icmp_ignore_bogus_error_responses" is not set to "1", this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.icmp_ignore_bogus_error_response /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf:net.ipv4.icmp_ignore_bogus_error_responses = 1

If "net.ipv4.icmp_ignore_bogus_error_response" is not set to "1" or is missing, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not log bogus ICMP errors: 

Add or edit the following line in a single system configuration file in the "/etc/sysctl.d/" directory:

net.ipv4.icmp_ignore_bogus_error_responses = 1

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257968
Rule ID:
SV-257968r1106339
STIG ID:
RHEL-09-253065
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not send Internet Control Message Protocol (ICMP) redirects.
Discussion:
ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages contain information from the system's route table possibly revealing portions of the network topology.

The ability to send ICMP redirects is only appropriate for systems acting as routers.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 does not IPv4 ICMP redirect messages.

Check the value of the "all send_redirects" variables with the following command:

$ sudo sysctl net.ipv4.conf.all.send_redirects

net.ipv4.conf.all.send_redirects = 0

If the returned line does not have a value of "0", or a line is not returned, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.conf.all.send_redirects /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv4.conf.all.send_redirects = 0

If "net.ipv4.conf.all.send_redirects" is not set to "0", is missing or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not allow interfaces to perform IPv4 ICMP redirects.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv4.conf.all.send_redirects=0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257970
Rule ID:
SV-257970r1106442
STIG ID:
RHEL-09-253075
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not enable IPv4 packet forwarding unless the system is a router.
Discussion:
Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this capability is used when not required, system network information may be unnecessarily transmitted across the network.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 is not performing IPv4 packet forwarding, unless the system is a router.

Check that IPv4 forwarding is disabled using the following command:

$ sudo sysctl net.ipv4.conf.all.forwarding

net.ipv4.conf.all.forwarding = 0

If the IPv4 forwarding value is not "0" and is not documented with the information system security officer (ISSO) as an operational requirement, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv4.conf.all.forwarding /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv4.conf.all.forwarding = 0

If "net.ipv4.conf.all.forwarding" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not allow IPv4 packet forwarding, unless the system is a router.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv4.conf.all.forwarding=0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257971
Rule ID:
SV-257971r1106444
STIG ID:
RHEL-09-254010
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not accept router advertisements on all IPv6 interfaces.
Discussion:
Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.

An illicit router advertisement message could result in a man-in-the-middle attack.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 does not accept router advertisements on all IPv6 interfaces, unless the system is a router.

Note: If IPv6 is disabled on the system, this requirement is not applicable.

Check to see if router advertisements are not accepted by using the following command:

$ sudo sysctl  net.ipv6.conf.all.accept_ra

net.ipv6.conf.all.accept_ra = 0

If the "accept_ra" value is not "0" and is not documented with the information system security officer (ISSO) as an operational requirement, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv6.conf.all.accept_ra /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv6.conf.all.accept_ra = 0

If "net.ipv6.conf.all.accept_ra" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not accept router advertisements on all IPv6 interfaces unless the system is a router.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv6.conf.all.accept_ra=0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257972
Rule ID:
SV-257972r1106446
STIG ID:
RHEL-09-254015
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must ignore IPv6 Internet Control Message Protocol (ICMP) redirect messages.
Discussion:
ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 ignores IPv6 ICMP redirect messages.

Note: If IPv6 is disabled on the system, this requirement is not applicable.

Check the value of the "accept_redirects" variables with the following command:

$ sudo sysctl net.ipv6.conf.all.accept_redirects

net.ipv6.conf.all.accept_redirects = 0

If the returned line does not have a value of "0", a line is not returned, or the line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv6.conf.all.accept_redirects /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv6.conf.all.accept_redirects = 0

If "net.ipv6.conf.all.accept_redirects" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to ignore IPv6 ICMP redirect messages.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv6.conf.all.accept_redirects = 0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257973
Rule ID:
SV-257973r1106448
STIG ID:
RHEL-09-254020
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not forward IPv6 source-routed packets.
Discussion:
Source-routed packets allow the source of the packet to suggest that routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures. This requirement applies only to the forwarding of source-routed traffic, such as when forwarding is enabled and the system is functioning as a router.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 does not accept IPv6 source-routed packets.

Note: If IPv6 is disabled on the system, this requirement is not applicable.

Check the value of the accept source route variable with the following command:

$ sudo sysctl net.ipv6.conf.all.accept_source_route

net.ipv6.conf.all.accept_source_route = 0

If the returned line does not have a value of "0", a line is not returned, or the line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv6.conf.all.accept_source_route /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv6.conf.all.accept_source_route = 0

If "net.ipv6.conf.all.accept_source_route" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not forward IPv6 source-routed packets.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv6.conf.all.accept_source_route=0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257974
Rule ID:
SV-257974r1106450
STIG ID:
RHEL-09-254025
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not enable IPv6 packet forwarding unless the system is a router.
Discussion:
Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 is not performing IPv6 packet forwarding, unless the system is a router.

Note: If IPv6 is disabled on the system, this requirement is not applicable.

Check that IPv6 forwarding is disabled using the following commands:

$ sudo sysctl net.ipv6.conf.all.forwarding

net.ipv6.conf.all.forwarding = 0

If the IPv6 forwarding value is not "0" and is not documented with the information system security officer (ISSO) as an operational requirement, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv6.conf.all.forwarding /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv6.conf.all.forwarding = 0

If "net.ipv6.conf.all.forwarding" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not allow IPv6 packet forwarding, unless the system is a router.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv6.conf.all.forwarding=0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257975
Rule ID:
SV-257975r1106452
STIG ID:
RHEL-09-254030
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not accept router advertisements on all IPv6 interfaces by default.
Discussion:
Routing protocol daemons are typically used on routers to exchange network topology information with other routers. If this software is used when not required, system network information may be unnecessarily transmitted across the network. An illicit router advertisement message could result in a man-in-the-middle attack.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 does not accept router advertisements on all IPv6 interfaces by default, unless the system is a router.

Note: If IPv6 is disabled on the system, this requirement is not applicable.

Check to see if router advertisements are not accepted by default by using the following command:

$ sudo sysctl  net.ipv6.conf.default.accept_ra

net.ipv6.conf.default.accept_ra = 0

If the "accept_ra" value is not "0" and is not documented with the information system security officer (ISSO) as an operational requirement, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv6.conf.default.accept_ra /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv6.conf.default.accept_ra = 0

If "net.ipv6.conf.default.accept_ra" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not accept router advertisements on all IPv6 interfaces by default unless the system is a router.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv6.conf.default.accept_ra=0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257976
Rule ID:
SV-257976r1106454
STIG ID:
RHEL-09-254035
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent IPv6 Internet Control Message Protocol (ICMP) redirect messages from being accepted.
Discussion:
ICMP redirect messages are used by routers to inform hosts that a more direct route exists for a particular destination. These messages modify the host's route table and are unauthenticated. An illicit ICMP redirect message could result in a man-in-the-middle attack.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 will not accept IPv6 ICMP redirect messages.

Note: If IPv6 is disabled on the system, this requirement is not applicable.

Check the value of the default "accept_redirects" variables with the following command:

$ sudo sysctl net.ipv6.conf.default.accept_redirects

net.ipv6.conf.default.accept_redirects = 0

If the returned line does not have a value of "0", a line is not returned, or the line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv6.conf.default.accept_redirects /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv6.conf.default.accept_redirects = 0

If "net.ipv6.conf.default.accept_redirects" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to prevent IPv6 ICMP redirect messages from being accepted.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv6.conf.default.accept_redirects = 0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257977
Rule ID:
SV-257977r1106456
STIG ID:
RHEL-09-254040
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not forward IPv6 source-routed packets by default.
Discussion:
Source-routed packets allow the source of the packet to suggest that routers forward the packet along a different path than configured on the router, which can be used to bypass network security measures. This requirement applies only to the forwarding of source-routed traffic, such as when forwarding is enabled and the system is functioning as a router.

Accepting source-routed packets in the IPv6 protocol has few legitimate uses. It must be disabled unless it is absolutely required.

The sysctl --system command will load settings from all system configuration files. All configuration files are sorted by their filename in lexicographic order, regardless of the directories in which they reside. If multiple files specify the same option, the entry in the file with the lexicographically latest name will take precedence. Files are read from directories in the following list from top to bottom. Once a file of a given filename is loaded, any file of the same name in subsequent directories is ignored.

/etc/sysctl.d/*.conf
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
Check Text:
Verify RHEL 9 does not accept IPv6 source-routed packets by default.

Note: If IPv6 is disabled on the system, this requirement is not applicable.

Check the value of the accept source route variable with the following command:

$ sudo sysctl net.ipv6.conf.default.accept_source_route

net.ipv6.conf.default.accept_source_route = 0

If the returned line does not have a value of "0", a line is not returned, or the line is commented out, this is a finding.

Check that the configuration files are present to enable this network parameter.

$ sudo grep -r net.ipv6.conf.default.accept_source_route /run/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf /etc/sysctl.d/*.conf

/etc/sysctl.d/99-sysctl.conf: net.ipv6.conf.default.accept_source_route = 0

If "net.ipv6.conf.default.accept_source_route" is not set to "0", is missing, or commented out, this is a finding.

If conflicting results are returned, this is a finding.
Fix Text:
Configure RHEL 9 to not forward IPv6 source-routed packets by default.

Add or edit the following line in a system configuration file in the "/etc/sysctl.d/" directory:

net.ipv6.conf.default.accept_source_route=0

Remove any configurations that conflict with the above from the following locations: 
/run/sysctl.d/*.conf
/usr/local/lib/sysctl.d/*.conf
/usr/lib/sysctl.d/*.conf
/lib/sysctl.d/*.conf
/etc/sysctl.conf
/etc/sysctl.d/*.conf

Load settings from all system configuration files with the following command:

$ sudo sysctl --system
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257980
Rule ID:
SV-257980r1045016
STIG ID:
RHEL-09-255020
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must have the openssh-clients package installed.
Discussion:
This package includes utilities to make encrypted connections and transfer files securely to SSH servers.
Check Text:
Verify that RHEL 9 has the openssh-clients package installed with the following command:

$ dnf list --installed openssh-clients

Example output:

openssh-clients.x86_64          8.7p1-8.el9

If the "openssh-clients" package is not installed, this is a finding.
Fix Text:
The openssh-clients package can be installed with the following command:
 
$ sudo dnf install openssh-clients
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257992
Rule ID:
SV-257992r1045047
STIG ID:
RHEL-09-255080
SRG ID:
SRG-OS-000480-GPOS-00229
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not allow a noncertificate trusted host SSH logon to the system.
Discussion:
SSH trust relationships mean a compromise on one host can allow an attacker to move trivially to other hosts.
Check Text:
Verify the operating system does not allow a noncertificate trusted host SSH logon to the system with the following command:

$ sudo /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*hostbasedauthentication'

HostbasedAuthentication no

If the "HostbasedAuthentication" keyword is not set to "no", is missing, or is commented out, this is a finding.

If the required value is not set, this is a finding.
Fix Text:
To configure RHEL 9 to not allow a noncertificate trusted host SSH logon to the system, add or modify the following line in "/etc/ssh/sshd_config" or in a file in "/etc/ssh/sshd_config.d".

HostbasedAuthentication no

Restart the SSH daemon for the settings to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257993
Rule ID:
SV-257993r1045049
STIG ID:
RHEL-09-255085
SRG ID:
SRG-OS-000480-GPOS-00229
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not allow users to override SSH environment variables.
Discussion:
SSH environment options potentially allow users to bypass access restriction in some configurations.
Check Text:
Verify that unattended or automatic logon via SSH is disabled with the following command:

$ sudo /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*permituserenvironment'

PermitUserEnvironment no

If "PermitUserEnvironment" is set to "yes", is missing completely, or is commented out, this is a finding.

If the required value is not set, this is a finding.
Fix Text:
Configure the RHEL 9 SSH daemon to not allow unattended or automatic logon to the system by editing the following line in the "/etc/ssh/sshd_config" or in a file in "/etc/ssh/sshd_config.d":

PermitUserEnvironment no

Restart the SSH daemon  for the setting to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257997
Rule ID:
SV-257997r1069370
STIG ID:
RHEL-09-255105
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH server configuration file must be group-owned by root.
Discussion:
Service configuration files enable or disable features of their respective services, which if configured incorrectly, can lead to insecure and vulnerable configurations. Therefore, service configuration files must be owned by the correct group to prevent unauthorized changes.
Check Text:
Verify the group ownership of the "/etc/ssh/sshd_config" file and the contents of "/etc/ssh/sshd_config.d" with the following command:

$ sudo find /etc/ssh/sshd_config /etc/ssh/sshd_config.d -exec stat -c "%G %n" {} \;

root /etc/ssh/sshd_config
root /etc/ssh/sshd_config.d
root /etc/ssh/sshd_config.d/50-cloud-init.conf
root /etc/ssh/sshd_config.d/50-redhat.conf

If the "/etc/ssh/sshd_config" file or "/etc/ssh/sshd_config.d" or any files in the sshd_config.d directory do not have a group owner of "root", this is a finding.
Fix Text:
Configure the "/etc/ssh/sshd_config" file and the contents of "/etc/ssh/sshd_config.d" to be group-owned by root with the following command:

$ sudo chgrp root /etc/ssh/sshd_config /etc/ssh/sshd_config.d
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257998
Rule ID:
SV-257998r1082181
STIG ID:
RHEL-09-255110
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
The RHEL 9 SSH server configuration file must be owned by root.
Discussion:
Service configuration files enable or disable features of their respective services, which if configured incorrectly, can lead to insecure and vulnerable configurations. Therefore, service configuration files must be owned by the correct group to prevent unauthorized changes.
Check Text:
Verify the ownership of the "/etc/ssh/sshd_config" file and the contents of "/etc/ssh/sshd_config.d" with the following command:

$ sudo find /etc/ssh/sshd_config /etc/ssh/sshd_config.d -exec stat -c "%U %n" {} \;

root /etc/ssh/sshd_config
root /etc/ssh/sshd_config.d
root /etc/ssh/sshd_config.d/50-cloud-init.conf
root /etc/ssh/sshd_config.d/50-redhat.conf

If the "/etc/ssh/sshd_config" file or "/etc/ssh/sshd_config.d" or any files in the "sshd_config.d" directory do not have an owner of "root", this is a finding.
Fix Text:
Configure  the "/etc/ssh/sshd_config" file and the contents of "/etc/ssh/sshd_config.d" to be owned by root with the following command:

$ sudo chown -R root /etc/ssh/sshd_config /etc/ssh/sshd_config.d
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-257999
Rule ID:
SV-257999r1082182
STIG ID:
RHEL-09-255115
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH server configuration files' permissions must not be modified.
Discussion:
Service configuration files enable or disable features of their respective services, that if configured incorrectly, can lead to insecure and vulnerable configurations. Therefore, service configuration files must have correct permissions (owner, group owner, mode) to prevent unauthorized changes.
Check Text:
Verify the permissions of the "/etc/ssh/sshd_config" file with the following command:

$ sudo rpm --verify openssh-server

If the command returns any output, this is a finding.
Fix Text:
Run the following commands to restore the correct permissions of OpenSSH server configuration files:

$ sudo dnf reinstall -y openssh-server
$ rpm --setugids openssh-server
$ rpm --setperms openssh-server
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258000
Rule ID:
SV-258000r1045063
STIG ID:
RHEL-09-255120
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH private host key files must have mode 0640 or less permissive.
Discussion:
If an unauthorized user obtains the private SSH host key file, the host could be impersonated.
Check Text:
Verify the SSH private host key files have a mode of "0640" or less permissive with the following command:

$ stat -c "%a %n" /etc/ssh/*_key

640 /etc/ssh/ssh_host_dsa_key
640 /etc/ssh/ssh_host_ecdsa_key
640 /etc/ssh/ssh_host_ed25519_key
640 /etc/ssh/ssh_host_rsa_key

If any private host key file has a mode more permissive than "0640", this is a finding.
Fix Text:
Configure the mode of SSH private host key files under "/etc/ssh" to "0640" with the following command:

$ sudo chmod 0640 /etc/ssh/ssh_host*key

Restart the SSH daemon for the changes to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258005
Rule ID:
SV-258005r1045069
STIG ID:
RHEL-09-255145
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH daemon must not allow rhosts authentication.
Discussion:
SSH trust relationships mean a compromise on one host can allow an attacker to move trivially to other hosts.
Check Text:
Verify the SSH daemon does not allow rhosts authentication with the following command:

$ sudo /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*ignorerhosts'

IgnoreRhosts yes

If the value is returned as "no", the returned line is commented out, or no output is returned, this is a finding.
Fix Text:
Configure the SSH daemon to not allow rhosts authentication.

Add the following line to "/etc/ssh/sshd_config" or to a file in "/etc/ssh/sshd_config.d", or uncomment the line and set the value to "yes":

IgnoreRhosts yes

The SSH service must be restarted for changes to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258006
Rule ID:
SV-258006r1045071
STIG ID:
RHEL-09-255150
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH daemon must not allow known hosts authentication.
Discussion:
Configuring the IgnoreUserKnownHosts setting for the SSH daemon provides additional assurance that remote login via SSH will require a password, even in the event of misconfiguration elsewhere.
Check Text:
Verify the SSH daemon does not allow known hosts authentication with the following command:

$ sudo /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*ignoreuserknownhosts'

IgnoreUserKnownHosts yes

If the value is returned as "no", the returned line is commented out, or no output is returned, this is a finding.
Fix Text:
Configure the SSH daemon to not allow known hosts authentication.

Add the following line to "/etc/ssh/sshd_config" or to a file in "/etc/ssh/sshd_config.d", or uncomment the line and set the value to "yes":

IgnoreUserKnownHosts yes

The SSH service must be restarted for changes to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258007
Rule ID:
SV-258007r1045073
STIG ID:
RHEL-09-255155
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH daemon must disable remote X connections for interactive users.
Discussion:
When X11 forwarding is enabled, there may be additional exposure to the server and client displays if the sshd proxy display is configured to listen on the wildcard address.  By default, sshd binds the forwarding server to the loopback address and sets the hostname part of the DISPLAY environment variable to localhost. This prevents remote hosts from connecting to the proxy display.
Check Text:
Verify the SSH daemon does not allow X11Forwarding with the following command:

$ sudo /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*x11forwarding'

X11forwarding no

If the value is returned as "yes", the returned line is commented out, or no output is returned, and X11 forwarding is not documented with the information system security officer (ISSO) as an operational requirement, this is a finding.
Fix Text:
Configure the SSH daemon to not allow X11 forwarding.

Add the following line to "/etc/ssh/sshd_config" or to a file in "/etc/ssh/sshd_config.d", or uncomment the line and set the value to "no":

X11forwarding no

The SSH service must be restarted for changes to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258008
Rule ID:
SV-258008r1045075
STIG ID:
RHEL-09-255160
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH daemon must perform strict mode checking of home directory configuration files.
Discussion:
If other users have access to modify user-specific SSH configuration files, they may be able to log into the system as another user.
Check Text:
Verify the SSH daemon performs strict mode checking of home directory configuration files with the following command:

$ sudo /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*strictmodes'

StrictModes yes

If the "StrictModes" keyword is set to "no", the returned line is commented out, or no output is returned, this is a finding.
Fix Text:
Configure the SSH daemon to perform strict mode checking of home directory configuration files.

Add the following line to "/etc/ssh/sshd_config" or to a file in "/etc/ssh/sshd_config.d", or uncomment the line and set the value to "yes":

StrictModes yes

The SSH service must be restarted for changes to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258009
Rule ID:
SV-258009r1045077
STIG ID:
RHEL-09-255165
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH daemon must display the date and time of the last successful account logon upon an SSH logon.
Discussion:
Providing users feedback on when account accesses last occurred facilitates user recognition and reporting of unauthorized account use.
Check Text:
Verify the SSH daemon provides users with feedback on when account accesses last occurred with the following command:

$ sudo /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*printlastlog'

PrintLastLog yes

If the "PrintLastLog" keyword is set to "no", the returned line is commented out, or no output is returned, this is a finding.
Fix Text:
Configure the SSH daemon to provide users with feedback on when account accesses last occurred.

Add the following line to "/etc/ssh/sshd_config" or to a file in "/etc/ssh/sshd_config.d", or uncomment the line and set the value to "yes":

PrintLastLog yes

The SSH service must be restarted for changes to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258011
Rule ID:
SV-258011r1045079
STIG ID:
RHEL-09-255175
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 SSH daemon must prevent remote hosts from connecting to the proxy display.
Discussion:
When X11 forwarding is enabled, there may be additional exposure to the server and client displays if the sshd proxy display is configured to listen on the wildcard address. By default, sshd binds the forwarding server to the loopback address and sets the hostname part of the "DISPLAY" environment variable to localhost. This prevents remote hosts from connecting to the proxy display.
Check Text:
Verify the SSH daemon prevents remote hosts from connecting to the proxy display with the following command:

$ sudo /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*x11uselocalhost'

X11UseLocalhost yes

If the "X11UseLocalhost" keyword is set to "no", is missing, or is commented out, this is a finding.
Fix Text:
Configure the SSH daemon to prevent remote hosts from connecting to the proxy display.

Add the following line to "/etc/ssh/sshd_config" or to a file in "/etc/ssh/sshd_config.d", or uncomment the line and set the value to "yes":

X11UseLocalhost yes

The SSH service must be restarted for changes to take effect:

$ sudo systemctl restart sshd.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258018
Rule ID:
SV-258018r1045090
STIG ID:
RHEL-09-271040
SRG ID:
SRG-OS-000480-GPOS-00229
Severity:
CAT I
Classification
Unclassified
Rule Title:
RHEL 9 must not allow unattended or automatic logon via the graphical user interface.
Discussion:
Failure to restrict system access to authenticated users negatively impacts operating system security.
Check Text:
Note: This requirement assumes the use of the RHEL 9 default graphical user interface, the GNOME desktop environment. If the system does not have any graphical user interface installed, this requirement is Not Applicable.

Verify RHEL 9 does not allow an unattended or automatic logon to the system via a graphical user interface.

Check for the value of the "AutomaticLoginEnable" in the "/etc/gdm/custom.conf" file with the following command:

$  grep -i automaticlogin /etc/gdm/custom.conf

AutomaticLoginEnable=false

If the value of "AutomaticLoginEnable" is not set to "false", this is a finding.
Fix Text:
Configure the GNOME desktop display manager to disable automatic login.

Set AutomaticLoginEnable to false in the [daemon] section in /etc/gdm/custom.conf. For example:

[daemon]
AutomaticLoginEnable=false
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258029
Rule ID:
SV-258029r1045109
STIG ID:
RHEL-09-271095
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable the ability of a user to restart the system from the login screen.
Discussion:
A user who is at the console can reboot the system at the login screen. If restart or shutdown buttons are pressed at the login screen, this can create the risk of short-term loss of availability of systems due to reboot.
Check Text:
Note: This requirement assumes the use of the RHEL 9 default graphical user interface, Gnome Shell. If the system does not have any graphical user interface installed, this requirement is Not Applicable.

Verify RHEL 9 disables a user's ability to restart the system with the following command:

$ gsettings get org.gnome.login-screen disable-restart-buttons
 
true
 
If "disable-restart-buttons" is "false", this is a finding.
Fix Text:
Configure RHEL 9 to disable a user's ability to restart the system.

$ gsettings set org.gnome.login-screen disable-restart-buttons true

Update the dconf system databases:

$ sudo dconf update
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258030
Rule ID:
SV-258030r1045112
STIG ID:
RHEL-09-271100
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent a user from overriding the disable-restart-buttons setting for the graphical user interface.
Discussion:
A user who is at the console can reboot the system at the login screen. If restart or shutdown buttons are pressed at the login screen, this can create the risk of short-term loss of availability of systems due to reboot.
Check Text:
Note: This requirement assumes the use of the RHEL 9 default graphical user interface, the GNOME desktop environment. If the system does not have any graphical user interface installed, this requirement is Not Applicable.

Verify RHEL 9 prevents a user from overriding the disable-restart-buttons setting for graphical user interfaces. 

$ gsettings writable org.gnome.login-screen disable-restart-buttons
 
false
 
If "disable-restart-buttons" is writable and the result is "true", this is a finding.
Fix Text:
Configure RHEL 9 to prevent a user from overriding the disable-restart-buttons setting for graphical user interfaces. 

Create a database to contain the systemwide graphical user logon settings (if it does not already exist) with the following command:

$ sudo touch /etc/dconf/db/local.d/locks/session

Add the following line to prevent nonprivileged users from modifying it:

/org/gnome/login-screen/disable-restart-buttons

Run the following command to update the database:

$ sudo dconf update
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258031
Rule ID:
SV-258031r1045114
STIG ID:
RHEL-09-271105
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable the ability of a user to accidentally press Ctrl-Alt-Del and cause a system to shut down or reboot.
Discussion:
A locally logged-in user who presses Ctrl-Alt-Del, when at the console, can reboot the system. If accidentally pressed, as could happen in the case of mixed OS environment, this can create the risk of short-term loss of availability of systems due to unintentional reboot.
Check Text:
Verify RHEL 9 is configured to ignore the Ctrl-Alt-Del sequence in the GNOME desktop with the following command:

Note: This requirement assumes the use of the RHEL 9 default graphical user interface, the GNOME desktop environment. If the system does not have any graphical user interface installed, this requirement is Not Applicable.

$ gsettings get org.gnome.settings-daemon.plugins.media-keys logout 

"['']"

If the GNOME desktop is configured to shut down when Ctrl-Alt-Del is pressed, this is a finding.
Fix Text:
Configure RHEL 9 to ignore the Ctrl-Alt-Del sequence in the GNOME desktop.

Run the following command to set the media-keys logout setting:

$ gsettings set org.gnome.settings-daemon.plugins.media-keys logout "['']"

Run the following command to update the database:

$ sudo dconf update
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258032
Rule ID:
SV-258032r1045117
STIG ID:
RHEL-09-271110
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent a user from overriding the Ctrl-Alt-Del sequence settings for the graphical user interface.
Discussion:
A locally logged-in user who presses Ctrl-Alt-Del, when at the console, can reboot the system. If accidentally pressed, as could happen in the case of mixed OS environment, this can create the risk of short-term loss of availability of systems due to unintentional reboot.
Check Text:
Note: This requirement assumes the use of the RHEL 9 default graphical user interface, the GNOME desktop environment. If the system does not have any graphical user interface installed, this requirement is Not Applicable.

Verify that users cannot enable the Ctrl-Alt-Del sequence in the GNOME desktop with the following command:

$ gsettings writable org.gnome.settings-daemon.plugins.media-keys logout
 
false
 
If "logout" is writable and the result is "true", this is a finding.
Fix Text:
Configure RHEL 9 to disallow the user changing the Ctrl-Alt-Del sequence in the GNOME desktop.

Create a database to contain the systemwide graphical user logon settings (if it does not already exist) with the following command:

$ sudo touch /etc/dconf/db/local.d/locks/session

Add the following line to the session locks file to prevent nonprivileged users from modifying the Ctrl-Alt-Del setting:

/org/gnome/settings-daemon/plugins/media-keys/logout

Run the following command to update the database:

$ sudo dconf update
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258033
Rule ID:
SV-258033r1045120
STIG ID:
RHEL-09-271115
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must disable the user list at logon for graphical user interfaces.
Discussion:
Leaving the user list enabled is a security risk since it allows anyone with physical access to the system to enumerate known user accounts without authenticated access to the system.
Check Text:
Note: This requirement assumes the use of the RHEL 9 default graphical user interface, the GNOME desktop environment. If the system does not have any graphical user interface installed, this requirement is Not Applicable.

Verify that RHEL 9 disables the user logon list for graphical user interfaces with the following command:

$ gsettings get org.gnome.login-screen disable-user-list

true

If the setting is "false", this is a finding.
Fix Text:
Configure RHEL 9 to disable the user list at logon for graphical user interfaces.

Create a database to contain the systemwide screensaver settings (if it does not already exist) with the following command:
Note: The example below is using the database "local" for the system. If the system is using another database in "/etc/dconf/profile/user", the file should be created under the appropriate subdirectory.

$ sudo touch /etc/dconf/db/local.d/02-login-screen

[org/gnome/login-screen]
disable-user-list=true

Update the system databases:

$ sudo dconf update
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258044
Rule ID:
SV-258044r1045135
STIG ID:
RHEL-09-411025
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must set the umask value to 077 for all local interactive user accounts.
Discussion:
The umask controls the default access mode assigned to newly created files. A umask of 077 limits new files to mode 600 or less permissive. Although umask can be represented as a four-digit number, the first digit representing special access modes is typically ignored or required to be "0". This requirement applies to the globally configured system defaults and the local interactive user defaults for each account on the system.
Check Text:
Verify that the default umask for all local interactive users is "077".

Identify the locations of all local interactive user home directories by looking at the "/etc/passwd" file.

Check all local interactive user initialization files for interactive users with the following command:

Note: The example is for a system that is configured to create users home directories in the "/home" directory.

$ sudo find /home -maxdepth 2 -type f -name ".[^.]*" -exec grep -iH -d skip --exclude=.bash_history umask {} \;

/home/wadea/.bash_history:grep -i umask /etc/bashrc /etc/csh.cshrc /etc/profile
/home/wadea/.bash_history:grep -i umask /etc/login.defs

If any local interactive user initialization files are found to have a umask statement that sets a value less restrictive than "077", this is a finding.
Fix Text:
Remove the umask statement from all local interactive user's initialization files. 

If the account is for an application, the requirement for a umask less restrictive than "077" can be documented with the information system security officer, but the user agreement for access to the account must specify that the local interactive user must log on to their account first and then switch the user to the application account with the correct option to gain the account's environment variables.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258050
Rule ID:
SV-258050r1045137
STIG ID:
RHEL-09-411055
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
Executable search paths within the initialization files of all local interactive RHEL 9 users must only contain paths that resolve to the system default or the users home directory.
Discussion:
The executable search path (typically the PATH environment variable) contains a list of directories for the shell to search to find executables. If this path includes the current working directory (other than the users home directory), executables in these directories may be executed instead of system commands.

This variable is formatted as a colon-separated list of directories. If there is an empty entry, such as a leading or trailing colon or two consecutive colons, this is interpreted as the current working directory. If deviations from the default system search path for the local interactive user are required, they must be documented with the information system security officer (ISSO).
Check Text:
Verify that all local interactive user initialization file executable search path statements do not contain statements that will reference a working directory other than user home directories with the following commands:

$ sudo find /home -maxdepth 2 -type f -name ".[^.]*" -exec grep -iH path= {} \;

PATH="$HOME/.local/bin:$HOME/bin:$PATH"

If any local interactive user initialization files have executable search path statements that include directories outside of their home directory, and this is not documented with the ISSO as an operational requirement, this is a finding.
Fix Text:
Edit the local interactive user initialization files to change any PATH variable statements that reference directories other than their home directory.

If a local interactive user requires path variables to reference a directory owned by the application, it must be documented with the ISSO.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258058
Rule ID:
SV-258058r1045148
STIG ID:
RHEL-09-411095
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must not have unauthorized accounts.
Discussion:
Accounts providing no operational purpose provide additional opportunities for system compromise. Unnecessary accounts include user accounts for individuals not requiring access to the system and application accounts for applications not installed on the system.
Check Text:
Verify that there are no unauthorized interactive user accounts with the following command:

$ less /etc/passwd  

root:x:0:0:root:/root:/bin/bash
...
games:x:12:100:games:/usr/games:/sbin/nologin
scsaustin:x:1001:1001:scsaustin:/home/scsaustin:/bin/bash
djohnson:x:1002:1002:djohnson:/home/djohnson:/bin/bash

Interactive user accounts generally will have a user identifier (UID) of 1000 or greater, a home directory in a specific partition, and an interactive shell.

Obtain the list of interactive user accounts authorized to be on the system from the system administrator or information system security officer (ISSO) and compare it to the list of local interactive user accounts on the system.

If there are unauthorized local user accounts on the system, this is a finding.
Fix Text:
Remove unauthorized local interactive user accounts with the following command where <unauthorized_user> is the unauthorized account:

$ sudo userdel  <unauthorized_user>
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258072
Rule ID:
SV-258072r1045155
STIG ID:
RHEL-09-412055
SRG ID:
SRG-OS-000480-GPOS-00228
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must define default permissions for the bash shell.
Discussion:
The umask controls the default access mode assigned to newly created files. A umask of 077 limits new files to mode 600 or less permissive. Although umask can be represented as a four-digit number, the first digit representing special access modes is typically ignored or required to be "0". This requirement applies to the globally configured system defaults and the local interactive user defaults for each account on the system.

Satisfies: SRG-OS-000480-GPOS-00228, SRG-OS-000480-GPOS-00227
Check Text:
Verify the "umask" setting is configured correctly in the "/etc/bashrc" file with the following command:

Note: If the value of the "umask" parameter is set to "000" "/etc/bashrc" file, the Severity is raised to a CAT I.

$ grep umask /etc/bashrc 

[ `umask` -eq 0 ] && umask 077  

If the value for the "umask" parameter is not "077", or the "umask" parameter is missing or is commented out, this is a finding.
Fix Text:
Configure RHEL 9 to define default permissions for all authenticated users using the bash shell.

Add or edit the lines for the "umask" parameter in the "/etc/bashrc" file to "077":

umask 077
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258073
Rule ID:
SV-258073r1045157
STIG ID:
RHEL-09-412060
SRG ID:
SRG-OS-000480-GPOS-00228
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must define default permissions for the c shell.
Discussion:
The umask controls the default access mode assigned to newly created files. A umask of 077 limits new files to mode 600 or less permissive. Although umask can be represented as a four-digit number, the first digit representing special access modes is typically ignored or required to be "0". This requirement applies to the globally configured system defaults and the local interactive user defaults for each account on the system.

Satisfies: SRG-OS-000480-GPOS-00228, SRG-OS-000480-GPOS-00227
Check Text:
Verify the "umask" setting is configured correctly in the "/etc/csh.cshrc" file with the following command:

Note: If the value of the "umask" parameter is set to "000" "/etc/csh.cshrc" file, the Severity is raised to a CAT I.

$ grep umask /etc/csh.cshrc 

umask 077

If the value for the "umask" parameter is not "077", or the "umask" parameter is missing or is commented out, this is a finding.
Fix Text:
Configure RHEL 9 to define default permissions for all authenticated users using the c shell.

Add or edit the lines for the "umask" parameter in the "/etc/csh.cshrc" file to "077":

umask 077
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258082
Rule ID:
SV-258082r1045166
STIG ID:
RHEL-09-431030
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 policycoreutils-python-utils package must be installed.
Discussion:
The policycoreutils-python-utils package is required to operate and manage an SELinux environment and its policies. It provides utilities such as semanage, audit2allow, audit2why, chcat, and sandbox.
Check Text:
Verify that RHEL 9 policycoreutils-python-utils service package is installed with the following command:

$ dnf list --installed policycoreutils-python-utils

Example output:

policycoreutils-python-utils.noarch          3.3-6.el9_0

If the "policycoreutils-python-utils" package is not installed, this is a finding.
Fix Text:
Install the policycoreutils-python-utils service package (if the policycoreutils-python-utils service is not already installed) with the following command:

$ sudo dnf install policycoreutils-python-utils
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258085
Rule ID:
SV-258085r1045173
STIG ID:
RHEL-09-432020
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must use the invoking user's password for privilege escalation when using "sudo".
Discussion:
If the rootpw, targetpw, or runaspw flags are defined and not disabled, by default the operating system will prompt the invoking user for the "root" user password.
Check Text:
Verify that the sudoers security policy is configured to use the invoking user's password for privilege escalation with the following command:

$ sudo egrep -ir '(!rootpw|!targetpw|!runaspw)' /etc/sudoers /etc/sudoers.d/ | grep -v '#'

/etc/sudoers:Defaults !targetpw
/etc/sudoers:Defaults !rootpw
/etc/sudoers:Defaults !runaspw

If no results are returned, this is a finding.

If results are returned from more than one file location, this is a finding.

If "Defaults !targetpw" is not defined, this is a finding.

If "Defaults !rootpw" is not defined, this is a finding.

If "Defaults !runaspw" is not defined, this is a finding.
Fix Text:
Define the following in the Defaults section of the /etc/sudoers file or a single configuration file in the /etc/sudoers.d/ directory:

Defaults !targetpw
Defaults !rootpw
Defaults !runaspw
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258087
Rule ID:
SV-258087r1102071
STIG ID:
RHEL-09-432030
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must restrict privilege elevation to authorized personnel.
Discussion:
If the "sudoers" file is not configured correctly, any user defined on the system can initiate privileged actions on the target system.
Check Text:
Verify RHEL 9 restricts privilege elevation to authorized personnel with the following command:

$ sudo grep -iwR 'ALL' /etc/sudoers /etc/sudoers.d/ | grep -v '#'

If the either of the following entries are returned, this is a finding:
ALL     ALL=(ALL) ALL
ALL     ALL=(ALL:ALL) ALL
Fix Text:
Remove the following entries from the /etc/sudoers file or configuration file under /etc/sudoers.d/:

ALL     ALL=(ALL) ALL
ALL     ALL=(ALL:ALL) ALL
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258094
Rule ID:
SV-258094r1045187
STIG ID:
RHEL-09-611025
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT I
Classification
Unclassified
Rule Title:
RHEL 9 must not allow blank or null passwords.
Discussion:
If an account has an empty password, anyone could log in and run commands with the privileges of that account. Accounts with empty passwords should never be used in operational environments.
Check Text:
Verify that null passwords cannot be used with the following command:

$ sudo grep -i nullok /etc/pam.d/system-auth /etc/pam.d/password-auth

If output is produced, this is a finding.

If the system administrator (SA) can demonstrate that the required configuration is contained in a PAM configuration file included or substacked from the system-auth file, this is not a finding.
Fix Text:
If PAM is managed with authselect, use the following command to remove instances of "nullok":
 
$ sudo authselect enable-feature without-nullok

Otherwise, remove any instances of the "nullok" option in the "/etc/pam.d/password-auth" and "/etc/pam.d/system-auth" files to prevent logons with empty passwords.

Note: Manual changes to the listed file may be overwritten by the "authselect" program.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258098
Rule ID:
SV-258098r1045195
STIG ID:
RHEL-09-611045
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must ensure the password complexity module is enabled in the system-auth file.
Discussion:
Enabling PAM password complexity permits enforcement of strong passwords and consequently makes the system less prone to dictionary attacks.
Check Text:
Verify RHEL 9 uses "pwquality" to enforce the password complexity rules in the system-auth file with the following command:

$ grep pam_pwquality /etc/pam.d/system-auth

password required pam_pwquality.so 

If the command does not return a line containing the value "pam_pwquality.so", or the line is commented out, this is a finding.

If the system administrator (SA) can demonstrate that the required configuration is contained in a PAM configuration file included or substacked from the system-auth file, this is not a finding.
Fix Text:
Configure RHEL 9 to use "pwquality" to enforce password complexity rules.

Add the following line to the "/etc/pam.d/system-auth" file(or modify the line to have the required value):

password required pam_pwquality.so
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258110
Rule ID:
SV-258110r1045223
STIG ID:
RHEL-09-611105
SRG ID:
SRG-OS-000480-GPOS-00225
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must prevent the use of dictionary words for passwords.
Discussion:
Use of a complex password helps to increase the time and resources required to compromise the password. Password complexity, or strength, is a measure of the effectiveness of a password in resisting attempts at guessing and brute-force attacks. If RHEL 9 allows the user to select passwords based on dictionary words, this increases the chances of password compromise by increasing the opportunity for successful guesses, and brute-force attacks.
Check Text:
Verify RHEL 9 prevents the use of dictionary words for passwords with the following command:

$ grep dictcheck /etc/security/pwquality.conf /etc/security/pwquality.conf.d/*.conf

/etc/security/pwquality.conf:dictcheck = 1

If "dictcheck" does not have a value other than "0", or is commented out, this is a finding.
Fix Text:
Configure RHEL 9 to prevent the use of dictionary words for passwords.

Add or update the following line in the "/etc/security/pwquality.conf" file or a configuration file in the "/etc/security/pwquality.conf.d/" directory to contain the "dictcheck" parameter:

dictcheck=1
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258136
Rule ID:
SV-258136r1045270
STIG ID:
RHEL-09-651020
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must use a file integrity tool that is configured to use FIPS 140-3-approved cryptographic hashes for validating file contents and directories.
Discussion:
RHEL 9 installation media ships with an optional file integrity tool called Advanced Intrusion Detection Environment (AIDE). AIDE is highly configurable at install time. This requirement assumes the "aide.conf" file is under the "/etc" directory.

File integrity tools use cryptographic hashes for verifying file contents and directories have not been altered. These hashes must be FIPS 140-3-approved cryptographic hashes.
Check Text:
Verify that AIDE is configured to use FIPS 140-3 file hashing with the following command:

$ sudo grep sha512 /etc/aide.conf 

All=p+i+n+u+g+s+m+S+sha512+acl+xattrs+selinux

If the "sha512" rule is not being used on all uncommented selection lines in the "/etc/aide.conf" file, or another file integrity tool is not using FIPS 140-3-approved cryptographic hashes for validating file contents and directories, this is a finding.
Fix Text:
Configure the file integrity tool to use FIPS 140-3 cryptographic hashes for validating file and directory contents. 

If AIDE is installed, ensure the "sha512" rule is present on all uncommented file and directory selection lists. Exclude any log files, or files expected to change frequently, to reduce unnecessary notifications.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258138
Rule ID:
SV-258138r1045274
STIG ID:
RHEL-09-651030
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT III
Classification
Unclassified
Rule Title:
RHEL 9 must be configured so that the file integrity tool verifies Access Control Lists (ACLs).
Discussion:
RHEL 9 installation media ships with an optional file integrity tool called Advanced Intrusion Detection Environment (AIDE). AIDE is highly configurable at install time. This requirement assumes the "aide.conf" file is under the "/etc" directory.

ACLs can provide permissions beyond those permitted through the file mode and must be verified by the file integrity tools.
Check Text:
Verify that AIDE is verifying ACLs with the following command:

$ sudo grep acl /etc/aide.conf

All= p+i+n+u+g+s+m+S+sha512+acl+xattrs+selinux

If the "acl" rule is not being used on all uncommented selection lines in the "/etc/aide.conf" file, or ACLs are not being checked by another file integrity tool, this is a finding.
Fix Text:
Configure the file integrity tool to check file and directory ACLs. 

If AIDE is installed, ensure the "acl" rule is present on all uncommented file and directory selection lists.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258139
Rule ID:
SV-258139r1045276
STIG ID:
RHEL-09-651035
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT III
Classification
Unclassified
Rule Title:
RHEL 9 must be configured so that the file integrity tool verifies extended attributes.
Discussion:
RHEL 9 installation media ships with an optional file integrity tool called Advanced Intrusion Detection Environment (AIDE). AIDE is highly configurable at install time. This requirement assumes the "aide.conf" file is under the "/etc" directory.

Extended attributes in file systems are used to contain arbitrary data and file metadata with security implications.
Check Text:
Verify that AIDE is configured to verify extended attributes with the following command:

$ sudo grep xattrs /etc/aide.conf

All= p+i+n+u+g+s+m+S+sha512+acl+xattrs+selinux

If the "xattrs" rule is not being used on all uncommented selection lines in the "/etc/aide.conf" file, or extended attributes are not being checked by another file integrity tool, this is a finding.
Fix Text:
Configure the file integrity tool to check file and directory extended attributes. 

If AIDE is installed, ensure the "xattrs" rule is present on all uncommented file and directory selection lists.
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258143
Rule ID:
SV-258143r1045283
STIG ID:
RHEL-09-652025
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must be configured so that the rsyslog daemon does not accept log messages from other servers unless the server is being used for log aggregation.
Discussion:
Unintentionally running a rsyslog server accepting remote messages puts the system at increased risk. Malicious rsyslog messages sent to the server could exploit vulnerabilities in the server software itself, could introduce misleading information into the system's logs, or could fill the system's storage leading to a denial of service.

If the system is intended to be a log aggregation server, its use must be documented with the information system security officer (ISSO).
Check Text:
Verify that RHEL 9 is not configured to receive remote logs using rsyslog with the following commands:

$ grep -i modload /etc/rsyslog.conf /etc/rsyslog.d/*

$ModLoad imtcp
$ModLoad imrelp
$ModLoad imudp

$ grep -i 'load="imtcp"' /etc/rsyslog.conf /etc/rsyslog.d/*

$ grep -i 'load="imrelp"' /etc/rsyslog.conf /etc/rsyslog.d/*

$ grep -i serverrun /etc/rsyslog.conf /etc/rsyslog.d/*

$InputTCPServerRun 514
$InputRELPServerRun 514
$InputUDPServerRun 514

$ grep -i 'port="\S*"' /etc/rsyslog.conf /etc/rsyslog.d/*

/etc/rsyslog.conf:#input(type="imudp" port="514")
/etc/rsyslog.conf:#input(type="imtcp" port="514")
/etc/rsyslog.conf:#Target="remote_host" Port="XXX" Protocol="tcp")

If any uncommented lines are returned by the commands, rsyslog is configured to receive remote messages, and this is a finding.

Note: An error about no files or directories from the above commands may be returned. This is not a finding.

If any modules are being loaded in the "/etc/rsyslog.conf" file or in the "/etc/rsyslog.d" subdirectories, ask to see the documentation for the system being used for log aggregation. 

If the documentation does not exist or does not specify the server as a log aggregation system, this is a finding.
Fix Text:
Configure RHEL 9 to not receive remote logs using rsyslog.

Remove the lines in /etc/rsyslog.conf and any files in the /etc/rsyslog.d directory that match any of the following:
module(load="imtcp")
module(load="imudp")
module(load="imrelp")
input(type="imudp" port="514")
input(type="imtcp" port="514")
input(type="imrelp" port="514")

The rsyslog daemon must be restarted for the changes to take effect:

$ sudo systemctl restart rsyslog.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b

============================================================================================================

Group ID:
V-258150
Rule ID:
SV-258150r1045296
STIG ID:
RHEL-09-652060
SRG ID:
SRG-OS-000480-GPOS-00227
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must use cron logging.
Discussion:
Cron logging can be used to trace the successful or unsuccessful execution of cron jobs. It can also be used to spot intrusions into the use of the cron facility by unauthorized and malicious users.
Check Text:
Verify that "rsyslog" is configured to log cron events with the following command:

Note: If another logging package is used, substitute the utility configuration file for "/etc/rsyslog.conf" or "/etc/rsyslog.d/*.conf" files.

$ grep -s cron /etc/rsyslog.conf /etc/rsyslog.d/*.conf

/etc/rsyslog.conf:*.info;mail.none;authpriv.none;cron.none /var/log/messages
/etc/rsyslog.conf:cron.* /var/log/cron

If the command does not return a response, check for cron logging all facilities with the following command:

$ logger -p local0.info "Test message for all facilities."

Check the logs for the test message with:

$ sudo tail /var/log/messages

If "rsyslog" is not logging messages for the cron facility or all facilities, this is a finding.
Fix Text:
Configure "rsyslog" to log all cron messages by adding or updating the following line to "/etc/rsyslog.conf" or a configuration file in the /etc/rsyslog.d/ directory:

cron.* /var/log/cron

The rsyslog daemon must be restarted for the changes to take effect:

$ sudo systemctl restart rsyslog.service
CCI-000366
Implement the security configuration settings.
NIST SP 800-53 :: CM-6 b
NIST SP 800-53A :: CM-6.1 (iv)
NIST SP 800-53 Revision 4 :: CM-6 b
NIST SP 800-53 Revision 5 :: CM-6 b


