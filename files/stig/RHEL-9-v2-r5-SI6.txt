Red Hat Enterprise Linux 9
Version: 2 Release: 5 Benchmark Date: 02 Jul 2025

************************************************************************************************************
SI-6 Security and Privacy Function Verification
************************************************************************************************************

Group ID:
V-258078
Rule ID:
SV-258078r958944
STIG ID:
RHEL-09-431010
SRG ID:
SRG-OS-000445-GPOS-00199
Severity:
CAT I
Classification
Unclassified
Rule Title:
RHEL 9 must use a Linux Security Module configured to enforce limits on system services.
Discussion:
Without verification of the security functions, security functions may not operate correctly and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.

This requirement applies to operating systems performing security function verification/testing and/or systems and environments that require this functionality.

Satisfies: SRG-OS-000445-GPOS-00199, SRG-OS-000134-GPOS-00068
Check Text:
Ensure that RHEL 9 verifies correct operation of security functions through the use of SELinux with the following command:

$ getenforce

Enforcing

If SELINUX is not set to "Enforcing", this is a finding.

Verify that SELinux is configured to be enforcing at boot.

grep "SELINUX=" /etc/selinux/config
# SELINUX= can take one of these three values:
# NOTE: In earlier Fedora kernel builds, SELINUX=disabled would also
SELINUX=enforcing

If SELINUX line is missing, commented out, or not set to "enforcing", this is a finding.
Fix Text:
Configure RHEL 9 to verify correct operation of security functions.

Edit the file "/etc/selinux/config" and add or modify the following line:

 SELINUX=enforcing 

A reboot is required for the changes to take effect.
CCI-001084
Isolate security functions from nonsecurity functions.
NIST SP 800-53 :: SC-3
NIST SP 800-53A :: SC-3.1 (ii)
NIST SP 800-53 Revision 4 :: SC-3
NIST SP 800-53 Revision 5 :: SC-3
CCI-002696
Verify correct operation of organization-defined security functions.
NIST SP 800-53 Revision 4 :: SI-6 a
NIST SP 800-53 Revision 5 :: SI-6 a

************************************************************************************************************

Group ID:
V-258079
Rule ID:
SV-258079r1045159
STIG ID:
RHEL-09-431015
SRG ID:
SRG-OS-000445-GPOS-00199
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must enable the SELinux targeted policy.
Discussion:
Setting the SELinux policy to "targeted" or a more specialized policy ensures the system will confine processes that are likely to be targeted for exploitation, such as network or system services.

Note: During the development or debugging of SELinux modules, it is common to temporarily place nonproduction systems in "permissive" mode. In such temporary cases, SELinux policies should be developed, and once work is completed, the system should be reconfigured to "targeted".
Check Text:
Verify the SELINUX on RHEL 9 is using the targeted policy with the following command:

$ sestatus | grep "policy name" 

Loaded policy name:             targeted

If the loaded policy name is not "targeted", this is a finding.
Fix Text:
Configure RHEL 9 to use the targetd SELINUX policy.

Edit the file "/etc/selinux/config" and add or modify the following line:

 SELINUXTYPE=targeted 

A reboot is required for the changes to take effect.
CCI-002696
Verify correct operation of organization-defined security functions.
NIST SP 800-53 Revision 4 :: SI-6 a
NIST SP 800-53 Revision 5 :: SI-6 a

************************************************************************************************************

Group ID:
V-258134
Rule ID:
SV-258134r1101983
STIG ID:
RHEL-09-651010
SRG ID:
SRG-OS-000363-GPOS-00150
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must have the AIDE package installed.
Discussion:
Without verification of the security functions, security functions may not operate correctly, and the failure may go unnoticed. Security function is defined as the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based. Security functionality includes, but is not limited to, establishing system accounts, configuring access authorizations (i.e., permissions, privileges), setting events to be audited, and setting intrusion detection parameters.

Selection lines in the aide.conf file determine which files and directories AIDE will monitor for changes. They follow this format:

<path> <rules>

The <path> specifies a file, directory or wildcard pattern to monitor.
The <rules>define which attributes (hashes, permissions, timestamps, etc.) to check.

Satisfies: SRG-OS-000363-GPOS-00150, SRG-OS-000445-GPOS-00199
Check Text:
Verify the file integrity tool is configured to verify ACLs.

Note: AIDE is highly configurable at install time. This requirement assumes the "aide.conf" file is under the "/etc" directory.

If AIDE is not installed, ask the system administrator (SA) how file integrity checks are performed on the system.

Use the following command to determine if the file is in a location other than "/etc/aide/aide.conf":

$ sudo find / -name aide.conf

Use the following command to review the "aide.conf" file to determine if the "acl" rule has been added to the rule list being applied to the files and directories selection lists:

$ sudo cat /etc/aide.conf | more

If the "acl" rule is not being used on all selection lines in the "/etc/aide.conf" file, is commented out, or ACLs are not being checked by another file integrity tool, this is a finding.
Fix Text:
Install AIDE, initialize it, and perform a manual check.

Install AIDE:

$ sudo dnf install aide

Initialize AIDE:
     
$ sudo /usr/sbin/aide --init

Example output:

Start timestamp: 2023-06-05 10:09:04 -0600 (AIDE 0.16)
AIDE initialized database at /var/lib/aide/aide.db.new.gz

Number of entries:      86833

---------------------------------------------------
The attributes of the (uncompressed) database(s):
---------------------------------------------------

/var/lib/aide/aide.db.new.gz
  MD5      : coZUtPHhoFoeD7+k54fUvQ==
  SHA1     : DVpOEMWJwo0uPgrKZAygIUgSxeM=
  SHA256   : EQiZH0XNEk001tcDmJa+5STFEjDb4MPE
             TGdBJ/uvZKc=
  SHA512   : 86KUqw++PZhoPK0SZvT3zuFq9yu9nnPP
             toei0nENVELJ1LPurjoMlRig6q69VR8l
             +44EwO9eYyy9nnbzQsfG1g==

End timestamp: 2023-06-05 10:09:57 -0600 (run time: 0m 53s)

The new database will need to be renamed to be read by AIDE:

$ sudo mv /var/lib/aide/aide.db.new.gz /var/lib/aide/aide.db.gz

Perform a manual check:

$ sudo /usr/sbin/aide --check

Example output:

2023-06-05 10:16:08 -0600 (AIDE 0.16)
AIDE found NO differences between database and filesystem. Looks okay!!

...
CCI-001744
Implement organization-defined security responses automatically if baseline configurations are changed in an unauthorized manner.
NIST SP 800-53 Revision 5 :: CM-3 (5)
NIST SP 800-53 Revision 4 :: CM-3 (5)
CCI-002696
Verify correct operation of organization-defined security functions.
NIST SP 800-53 Revision 4 :: SI-6 a
NIST SP 800-53 Revision 5 :: SI-6 a

************************************************************************************************************

Group ID:
V-258135
Rule ID:
SV-258135r1045267
STIG ID:
RHEL-09-651015
SRG ID:
SRG-OS-000363-GPOS-00150
Severity:
CAT II
Classification
Unclassified
Rule Title:
RHEL 9 must routinely check the baseline configuration for unauthorized changes and notify the system administrator when anomalies in the operation of any security functions are discovered.
Discussion:
Unauthorized changes to the baseline configuration could make the system vulnerable to various attacks or allow unauthorized access to the operating system. Changes to operating system configurations can have unintended side effects, some of which may be relevant to security.

Detecting such changes and providing an automated response can help avoid unintended, negative consequences that could ultimately affect the security state of the operating system. The operating system's information management officer (IMO)/information system security officer (ISSO) and system administrators (SAs) must be notified via email and/or monitoring system trap when there is an unauthorized modification of a configuration item.

Notifications provided by information systems include messages to local computer consoles, and/or hardware indications, such as lights.

This capability must take into account operational requirements for availability for selecting an appropriate response. The organization may choose to shut down or restart the information system upon security function anomaly detection.

Satisfies: SRG-OS-000363-GPOS-00150, SRG-OS-000446-GPOS-00200, SRG-OS-000447-GPOS-00201
Check Text:
Verify that RHEL 9 routinely executes a file integrity scan for changes to the system baseline. The command used in the example will use a daily occurrence.

Check the cron directories for scripts controlling the execution and notification of results of the file integrity application. For example, if AIDE is installed on the system, use the following commands:

$ sudo ls -al /etc/cron.* | grep aide

-rwxr-xr-x 1 root root 29 Nov 22 2015 aide

$ sudo grep aide /etc/crontab /var/spool/cron/root

/etc/crontab: 30 04 * * * root usr/sbin/aide
/var/spool/cron/root: 30 04 * * * root usr/sbin/aide

$ sudo more /etc/cron.daily/aide

#!/bin/bash
/usr/sbin/aide --check | /bin/mail -s "$HOSTNAME - Daily aide integrity check run" root@sysname.mil

If the file integrity application does not exist, a script file controlling the execution of the file integrity application does not exist, or the file integrity application does not notify designated personnel of changes, this is a finding.
Fix Text:
Configure the file integrity tool to run automatically on the system at least weekly and to notify designated personnel if baseline configurations are changed in an unauthorized manner. The AIDE tool can be configured to email designated personnel with the use of the cron system.
 
The following example output is generic. It will set cron to run AIDE daily and to send email at the completion of the analysis

$ sudo more /etc/cron.daily/aide
 
#!/bin/bash
/usr/sbin/aide --check | /bin/mail -s "$HOSTNAME - Daily aide integrity check run" root@sysname.mil
CCI-001744
Implement organization-defined security responses automatically if baseline configurations are changed in an unauthorized manner.
NIST SP 800-53 Revision 5 :: CM-3 (5)
NIST SP 800-53 Revision 4 :: CM-3 (5)
CCI-002699
Perform verification of the correct operation of organization-defined security functions: when the system is in an organization-defined transitional state; upon command by a user with appropriate privileges; and/or on an organization-defined frequency.
NIST SP 800-53 Revision 4 :: SI-6 b
NIST SP 800-53 Revision 5 :: SI-6 b
CCI-002702
Shut the system down, restart the system, and/or initiate organization-defined alternative action(s) when anomalies in the operation of the organization-defined security functions are discovered.
NIST SP 800-53 Revision 4 :: SI-6 d
NIST SP 800-53 Revision 5 :: SI-6 d
